<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Simulations | An R Package for Change Point Detection</title>
  <meta name="description" content="4 Simulations | An R Package for Change Point Detection" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Simulations | An R Package for Change Point Detection" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Simulations | An R Package for Change Point Detection" />
  
  
  

<meta name="author" content="Thales Mello" />
<meta name="author" content="Florencia Leonardi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="solution-estimation.html"/>
<link rel="next" href="real-data-examples.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#related-work"><i class="fa fa-check"></i><b>1.1</b> Related Work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="main-definition.html"><a href="main-definition.html"><i class="fa fa-check"></i><b>2</b> Main Definition</a><ul>
<li class="chapter" data-level="2.1" data-path="main-definition.html"><a href="main-definition.html#a-sequence-of-random-variables-and-its-segments"><i class="fa fa-check"></i><b>2.1</b> A Sequence of Random Variables and Its Segments</a></li>
<li class="chapter" data-level="2.2" data-path="main-definition.html"><a href="main-definition.html#the-segmentation-problem"><i class="fa fa-check"></i><b>2.2</b> The Segmentation Problem</a></li>
<li class="chapter" data-level="2.3" data-path="main-definition.html"><a href="main-definition.html#the-hausdorff-distance"><i class="fa fa-check"></i><b>2.3</b> The Hausdorff Distance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="solution-estimation.html"><a href="solution-estimation.html"><i class="fa fa-check"></i><b>3</b> Solution Estimation</a><ul>
<li class="chapter" data-level="3.1" data-path="solution-estimation.html"><a href="solution-estimation.html#exact-algorithm"><i class="fa fa-check"></i><b>3.1</b> Exact Algorithm</a></li>
<li class="chapter" data-level="3.2" data-path="solution-estimation.html"><a href="solution-estimation.html#hierarchical-algorithm"><i class="fa fa-check"></i><b>3.2</b> Hierarchical Algorithm</a></li>
<li class="chapter" data-level="3.3" data-path="solution-estimation.html"><a href="solution-estimation.html#hybrid-algorithm"><i class="fa fa-check"></i><b>3.3</b> Hybrid Algorithm</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>4</b> Simulations</a><ul>
<li class="chapter" data-level="4.1" data-path="simulations.html"><a href="simulations.html#segments-of-independent-variables"><i class="fa fa-check"></i><b>4.1</b> Segments of Independent Variables</a></li>
<li class="chapter" data-level="4.2" data-path="simulations.html"><a href="simulations.html#segments-with-similar-averages"><i class="fa fa-check"></i><b>4.2</b> Segments with Similar Averages</a></li>
<li class="chapter" data-level="4.3" data-path="simulations.html"><a href="simulations.html#accuracy-of-algorithms-using-different-algorithms"><i class="fa fa-check"></i><b>4.3</b> Accuracy of Algorithms Using Different Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="real-data-examples.html"><a href="real-data-examples.html"><i class="fa fa-check"></i><b>5</b> Real Data Examples</a><ul>
<li class="chapter" data-level="5.1" data-path="real-data-examples.html"><a href="real-data-examples.html#understanding-the-data"><i class="fa fa-check"></i><b>5.1</b> Understanding the Data</a></li>
<li class="chapter" data-level="5.2" data-path="real-data-examples.html"><a href="real-data-examples.html#building-the-cost-function"><i class="fa fa-check"></i><b>5.2</b> Building the Cost Function</a></li>
<li class="chapter" data-level="5.3" data-path="real-data-examples.html"><a href="real-data-examples.html#penalizing-the-cost-function"><i class="fa fa-check"></i><b>5.3</b> Penalizing the Cost Function</a></li>
<li class="chapter" data-level="5.4" data-path="real-data-examples.html"><a href="real-data-examples.html#reducing-granularity"><i class="fa fa-check"></i><b>5.4</b> Reducing Granularity</a></li>
<li class="chapter" data-level="5.5" data-path="real-data-examples.html"><a href="real-data-examples.html#accuracy-of-estimates-for-the-berlin-data-set"><i class="fa fa-check"></i><b>5.5</b> Accuracy of Estimates for the Berlin Data Set</a></li>
<li class="chapter" data-level="5.6" data-path="real-data-examples.html"><a href="real-data-examples.html#a-non-usual-cost-function"><i class="fa fa-check"></i><b>5.6</b> A Non-Usual Cost Function</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html"><i class="fa fa-check"></i><b>6</b> Considerations on Performance</a><ul>
<li class="chapter" data-level="6.1" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html#benchmark-the-code"><i class="fa fa-check"></i><b>6.1</b> Benchmark the Code</a></li>
<li class="chapter" data-level="6.2" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html#native-code"><i class="fa fa-check"></i><b>6.2</b> Native Code</a></li>
<li class="chapter" data-level="6.3" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html#parallelization"><i class="fa fa-check"></i><b>6.3</b> Parallelization</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="package-usage.html"><a href="package-usage.html"><i class="fa fa-check"></i><b>A</b> Package Usage</a><ul>
<li class="chapter" data-level="A.1" data-path="package-usage.html"><a href="package-usage.html#installation"><i class="fa fa-check"></i><b>A.1</b> Installation</a></li>
<li class="chapter" data-level="A.2" data-path="package-usage.html"><a href="package-usage.html#usage"><i class="fa fa-check"></i><b>A.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="support-code.html"><a href="support-code.html"><i class="fa fa-check"></i><b>B</b> Support Code</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R Package for Change Point Detection</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulations" class="section level1">
<h1><span class="header-section-number">4</span> Simulations</h1>
<p>To exemplify the utility of this package, a handful of hypothetical
data will be presented, together with a proposal of an appropriate cost
function that is expected to segment the data.</p>
<div id="segments-of-independent-variables" class="section level2">
<h2><span class="header-section-number">4.1</span> Segments of Independent Variables</h2>
<p>To show compatibility with the work presented in <span class="citation">(Castro et al. <a href="#ref-base-paper" role="doc-biblioref">2018</a>)</span>, we analyze the
same problem presented in their work.</p>
<p>Let <span class="math inline">\(N = (N_1, \dots , N_6)\)</span> be a sequence of independent random variables with standard normal
distributions and let <span class="math inline">\(X = (X_1, \dots , X_15)\)</span> be another sequence of random variables dependent
on <span class="math inline">\(N\)</span>, with relationships described in <a href="simulations.html#eq:examplecolumns">(4.1)</a>. From the relationships, it’s
possible to see the first segment <span class="math inline">\(X_1, ..., X_5\)</span> depend on <span class="math inline">\(N_1, N_2\)</span>, the second segment
<span class="math inline">\(X_6, ..., X_{10}\)</span> depend on <span class="math inline">\(N_3, N_4\)</span> and the third and last segment <span class="math inline">\(X_{11}, ..., X_{15}\)</span>
depend on <span class="math inline">\(X_4, X_5\)</span>. Therefore, the set of change points for <span class="math inline">\(X\)</span> is <span class="math inline">\(C = {6, 11}\)</span>.</p>
<p><span class="math display" id="eq:examplecolumns">\[\begin{equation}
\begin{aligned}
X_1 &amp; = N_1 \\
X_2 &amp; = N_1 - N_2 \\
X_3 &amp; = N_2 \\
X_4 &amp; = N_1 + N_2 \\
X_5 &amp; = N_1 \\
X_6 &amp; = N_3 \\
X_7 &amp; = N_3 - N_4 \\
X_8 &amp; = N_4 \\
X_9 &amp; = N_3 + N_4 \\
X_{10} &amp; = N_3 \\
X_{11} &amp; = N_5 \\
X_{12} &amp; = N_5 - N_6 \\
X_{13} &amp; = N_6 \\
X_{14} &amp; = N_5 + N_6 \\
X_{15} &amp; = N_5
\end{aligned}
\tag{4.1}
\end{equation}\]</span></p>
<p>Given <span class="math inline">\(D\)</span>, illustrated in <a href="simulations.html#tab:sample-columns">4.1</a>, a sample data set of the
sequence of random variables <span class="math inline">\(X\)</span>, the multivariate likelihood function <span class="math inline">\(L\)</span>
<span class="citation">(Park <a href="#ref-park2017fundamentals" role="doc-biblioref">2017</a>)</span> can be used to estimate the likelihood of a given
segment in the discrete data set, as described in
<a href="simulations.html#eq:multivariatelikelihood">(4.2)</a>. The <code>multivariate()</code> is a fast native-code
implementation of that function that is available in the <code>segmentr</code> package. We
then use that likelihood function to define a penalized cost <span class="math inline">\(K\)</span> in
<a href="simulations.html#eq:costforexamplecolumns">(4.3)</a> with an extra term to penalize segments that
are too large, based on the number of columns <span class="math inline">\(\text{ncol}(D)\)</span> of the segment.</p>
<p><span class="math display" id="eq:multivariatelikelihood">\[\begin{equation}
\log(L(X|D)) = \sum_{k=0}^t P(X_{c_k:c_{k+1}-1} = D_{c_k:c_{k+1}-1})
\tag{4.2}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:costforexamplecolumns">\[\begin{equation}
K(D) = - \log(L(D)) + \text{ncol}(D)
\tag{4.3}
\end{equation}\]</span></p>
<p>Therefore, the cost function <span class="math inline">\(K\)</span> applied over a sample <span class="math inline">\(D\)</span>, shown in of <span class="math inline">\(X\)</span>
provides the same set of expected change points <span class="math inline">\(C\)</span>, as Table
<a href="simulations.html#tab:results-multivariate-penalized">4.2</a> show. Notice it’s important to use a
penalized cost function because the original likelihood function tends to favor
bigger segments. An estimate of the segments using an unpenalized cost is shown
in Table <a href="simulations.html#tab:results-multivariate-non-penalized">4.3</a>.</p>
<p>(ref:sample-columns-caption) Sample values of the correlated random variables
defined in <a href="simulations.html#eq:examplecolumns">(4.1)</a>.</p>
<table>
<caption>
<span id="tab:sample-columns">Table 4.1: </span>Sample values of the correlated random
variables defined in <a href="simulations.html#eq:examplecolumns">(4.1)</a>.
</caption>
<thead>
<tr>
<th style="text-align:right;">
X1
</th>
<th style="text-align:right;">
X2
</th>
<th style="text-align:right;">
X3
</th>
<th style="text-align:right;">
X4
</th>
<th style="text-align:right;">
X5
</th>
<th style="text-align:right;">
X6
</th>
<th style="text-align:right;">
X7
</th>
<th style="text-align:right;">
X8
</th>
<th style="text-align:right;">
X9
</th>
<th style="text-align:right;">
X10
</th>
<th style="text-align:right;">
X11
</th>
<th style="text-align:right;">
X12
</th>
<th style="text-align:right;">
X13
</th>
<th style="text-align:right;">
X14
</th>
<th style="text-align:right;">
X15
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>

<table>
<caption>
<span id="tab:results-multivariate-penalized">Table 4.2: </span>Segment tables as defined in
<a href="simulations.html#eq:examplecolumns">(4.1)</a>.
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:results-multivariate-non-penalized">Table 4.3: </span>Results of segmentation using a non-penalized
multivariate cost
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
15
</td>
</tr>
</tbody>
</table>
</div>
<div id="segments-with-similar-averages" class="section level2">
<h2><span class="header-section-number">4.2</span> Segments with Similar Averages</h2>
<p><span class="citation">(Ceballos et al. <a href="#ref-homozygosity" role="doc-biblioref">2018</a>)</span> describes a process on how to find windows of contiguous
homozygosity, i.e. segments in the genetic data in which the alleles are of the
same type. This is of interest to a researcher investigating diseases.
Considering this problems scenario, <code>segmentr</code> can be used to segment random
variables <span class="math inline">\(X_1, ..., X_m\)</span> that represent genetic data, encoded as zero for
homozygosity and one for heterozygosity, i.e. <span class="math inline">\(0\)</span> when the alleles are the
same and <span class="math inline">\(1\)</span> when different.</p>
<p>So, to use <code>segmentr</code> to solve this problem, it’s necessary to find a cost
function that favors the homogeneity of a given segment. That problem
is approached by proposing a heterogeneity cost function, i.e. a function that
penalized the segments whose elements are far from the segment average. One
such function is defined in <a href="simulations.html#eq:heterogeneitycost">(4.4)</a>. Notice, however, the
cost function proposed favors single column segments, as it’s the size
for which all the elements approximate the segment average the most. To counter
this undesirable behavior, we penalized the function by adding a constant to
it, as described in <a href="simulations.html#eq:penalizedheterogeneitycost">(4.5)</a>. The constant factor
has the effect of adding up when too many segments are considered in the
estimation process, making it so wider segments end being picked up in the
estimation process.</p>
<p>In order to observe how the proposed function behaves, consider the simple
example defined in <a href="simulations.html#eq:geneticexample">(4.6)</a>, in which <span class="math inline">\(X_i\)</span> for <span class="math inline">\(i \in \{1, \dots, 20\}\)</span> represent each a column indexed by <span class="math inline">\(i\)</span> of a data set <span class="math inline">\(D\)</span>, and
<span class="math inline">\(\text{Bern(p)}\)</span> representing the Bernoulli distribution with probability <span class="math inline">\(p\)</span>.
The result for applying <a href="simulations.html#eq:penalizedheterogeneitycost">(4.5)</a> over <a href="simulations.html#eq:geneticexample">(4.6)</a>
is shown in Table <a href="simulations.html#tab:results-penalized-mean">4.4</a>.</p>
<p><span class="math display" id="eq:heterogeneitycost">\[\begin{equation}
K(D)=\sum_i(D_i-E[D])^2
\tag{4.4}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:penalizedheterogeneitycost">\[\begin{equation}
K_p(D)=K(D) + 1
\tag{4.5}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:geneticexample">\[\begin{equation}
\begin{aligned}
X_{1} &amp; \sim \text{Bern}(0.9) \\
X_{2} &amp; \sim \text{Bern}(0.9) \\
X_{3} &amp; \sim \text{Bern}(0.9) \\
X_{4} &amp; \sim \text{Bern}(0.9) \\
X_{5} &amp; \sim \text{Bern}(0.9) \\
X_{6} &amp; \sim \text{Bern}(0.1) \\
X_{7} &amp; \sim \text{Bern}(0.1) \\
X_{8} &amp; \sim \text{Bern}(0.1) \\
X_{9} &amp; \sim \text{Bern}(0.1) \\
X_{10} &amp; \sim \text{Bern}(0.1) \\
X_{11} &amp; \sim \text{Bern}(0.1) \\
X_{12} &amp; \sim \text{Bern}(0.1) \\
X_{13} &amp; \sim \text{Bern}(0.1) \\
X_{14} &amp; \sim \text{Bern}(0.1) \\
X_{15} &amp; \sim \text{Bern}(0.1) \\
X_{16} &amp; \sim \text{Bern}(0.9) \\
X_{17} &amp; \sim \text{Bern}(0.9) \\
X_{18} &amp; \sim \text{Bern}(0.9) \\
X_{19} &amp; \sim \text{Bern}(0.9) \\
X_{20} &amp; \sim \text{Bern}(0.9)
\end{aligned}
\tag{4.6}
\end{equation}\]</span></p>


<table>
<caption>
<span id="tab:results-penalized-mean">Table 4.4: </span>Results of segmentation by applying the
cost function defined in
<a href="simulations.html#eq:penalizedheterogeneitycost">(4.5)</a> to a sample of size
10 of the model defined in <a href="simulations.html#eq:geneticexample">(4.6)</a>.
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
15
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
20
</td>
</tr>
</tbody>
</table>
</div>
<div id="accuracy-of-algorithms-using-different-algorithms" class="section level2">
<h2><span class="header-section-number">4.3</span> Accuracy of Algorithms Using Different Algorithms</h2>
<p>Given different solutions obtained by the <code>segment</code> function, it’s often
necessary to compare them with each other. For that, the Hausdorff distance,
defined in Chapter <a href="main-definition.html#the-hausdorff-distance">2.3</a>, can be used to measure a
distance between two sets of estimated change points.</p>
<p>We want to measure how well the different algorithms provided in the <code>segmentr</code>
package find the segments in the example correlated columns simulated data set
described in <a href="simulations.html#eq:examplecolumns">(4.1)</a>. Since the simulation was arbitrarily
built, we know what the exact solution to the segmentation problem is.</p>
<table>
<caption>
<span id="tab:hausdorff-multivariate-comparison">Table 4.5: </span>Comparison of solutions of different algorithms
to segment the data set described in <a href="simulations.html#eq:examplecolumns">(4.1)</a>,
measuring how far each solution is from the ideal
solution using the Hausdorff distance.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Changepoints
</th>
<th style="text-align:right;">
Hausdorff Distance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Expected solution
</td>
<td style="text-align:left;">
6, 11
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Exact algorithm estimate
</td>
<td style="text-align:left;">
6, 11
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hierarchical algorithm estimate
</td>
<td style="text-align:left;">
6, 8, 11
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Hybrid algorithm estimate with threshold 50
</td>
<td style="text-align:left;">
6, 11
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hybrid algorithm estimate with threshold 4
</td>
<td style="text-align:left;">
6, 8, 11
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>Therefore, in Table <a href="simulations.html#tab:hausdorff-multivariate-comparison">4.5</a> we can see the
comparison of different algorithms with different parameters. We notice the
“exact” algorithm manages to properly match the expected change points
solution, whereas the “hierarchical” algorithm finds an extra segment, which
causes the Hausdorff distance to be bigger than zero. The two “hybrid”
algorithm cases are interesting in the sense it that it shows how to algorithm
works by either adopting the exact or the hierarchical algorithm depending on
the threshold and the size of the segment being analyzed. When the threshold
argument is large, it applies the exact algorithm to the data set, whereas when
the threshold is small, it applies the hierarchical algorithm instead.</p>
<p>Consider now the simulated data set of segments with similar averages described
in equation <a href="simulations.html#eq:geneticexample">(4.6)</a>. We do the same algorithm comparison with
this data set in Table <a href="simulations.html#tab:hausdorff-mean-comparison">4.6</a>. In contrast with
the previous experiment, all the algorithms manage to find the expected solution
to the problem.</p>
<table>
<caption>
<span id="tab:hausdorff-mean-comparison">Table 4.6: </span>Comparison of solutions of different algorithms
to segment the data set described in <a href="simulations.html#eq:geneticexample">(4.6)</a>,
measuring how far each solution is from the ideal
solution using the Hausdorff distance.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Changepoints
</th>
<th style="text-align:right;">
Hausdorff Distance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Expected solution
</td>
<td style="text-align:left;">
6, 16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Exact algorithm estimate
</td>
<td style="text-align:left;">
6, 16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hierarchical algorithm estimate
</td>
<td style="text-align:left;">
6, 16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hybrid algorithm estimate with threshold 50
</td>
<td style="text-align:left;">
6, 16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Hybrid algorithm estimate with threshold 4
</td>
<td style="text-align:left;">
6, 16
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-base-paper">
<p>Castro, Bruno M., Renan B. Lemes, Jonatas Cesar, Tábita Hünemeier, and Florencia Leonardi. 2018. “A Model Selection Approach for Multiple Sequence Segmentation and Dimensionality Reduction.” <em>Journal of Multivariate Analysis</em> 167: 319–30. <a href="https://doi.org/https://doi.org/10.1016/j.jmva.2018.05.006">https://doi.org/https://doi.org/10.1016/j.jmva.2018.05.006</a>.</p>
</div>
<div id="ref-homozygosity">
<p>Ceballos, Francisco, Peter Joshi, David W. Clark, Michèle Ramsay, and James F. Wilson. 2018. “Runs of Homozygosity: Windows into Population History and Trait Architecture.” <em>Nature Reviews Genetics</em> 19 (January). <a href="https://doi.org/10.1038/nrg.2017.109">https://doi.org/10.1038/nrg.2017.109</a>.</p>
</div>
<div id="ref-park2017fundamentals">
<p>Park, K. I. 2017. <em>Fundamentals of Probability and Stochastic Processes with Applications to Communications</em>. Springer International Publishing. <a href="https://books.google.com.br/books?id=cd2SswEACAAJ">https://books.google.com.br/books?id=cd2SswEACAAJ</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="solution-estimation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="real-data-examples.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
