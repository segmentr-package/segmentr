<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Real Data Examples | An R Package for Change Point Detection</title>
  <meta name="description" content="5 Real Data Examples | An R Package for Change Point Detection" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Real Data Examples | An R Package for Change Point Detection" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Real Data Examples | An R Package for Change Point Detection" />
  
  
  

<meta name="author" content="Thales Mello" />
<meta name="author" content="Florencia Leonardi" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulations.html"/>
<link rel="next" href="considerations-on-performance.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#related-work"><i class="fa fa-check"></i><b>1.1</b> Related Work</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="main-definition.html"><a href="main-definition.html"><i class="fa fa-check"></i><b>2</b> Main Definition</a><ul>
<li class="chapter" data-level="2.1" data-path="main-definition.html"><a href="main-definition.html#a-sequence-of-random-variables-and-its-segments"><i class="fa fa-check"></i><b>2.1</b> A sequence of random variables and its segments</a></li>
<li class="chapter" data-level="2.2" data-path="main-definition.html"><a href="main-definition.html#the-segmentation-problem"><i class="fa fa-check"></i><b>2.2</b> The segmentation problem</a></li>
<li class="chapter" data-level="2.3" data-path="main-definition.html"><a href="main-definition.html#the-hausdorff-distance"><i class="fa fa-check"></i><b>2.3</b> The Hausdorff distance</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="solution-estimation.html"><a href="solution-estimation.html"><i class="fa fa-check"></i><b>3</b> Solution Estimation</a><ul>
<li class="chapter" data-level="3.1" data-path="solution-estimation.html"><a href="solution-estimation.html#exact-algorithm"><i class="fa fa-check"></i><b>3.1</b> Exact Algorithm</a></li>
<li class="chapter" data-level="3.2" data-path="solution-estimation.html"><a href="solution-estimation.html#hierarchical-algorithm"><i class="fa fa-check"></i><b>3.2</b> Hierarchical Algorithm</a></li>
<li class="chapter" data-level="3.3" data-path="solution-estimation.html"><a href="solution-estimation.html#hybrid-algorithm"><i class="fa fa-check"></i><b>3.3</b> Hybrid algorithm</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>4</b> Simulations</a><ul>
<li class="chapter" data-level="4.1" data-path="simulations.html"><a href="simulations.html#segments-of-independent-variables"><i class="fa fa-check"></i><b>4.1</b> Segments of Independent Variables</a></li>
<li class="chapter" data-level="4.2" data-path="simulations.html"><a href="simulations.html#segments-with-similar-averages"><i class="fa fa-check"></i><b>4.2</b> Segments with similar averages</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="real-data-examples.html"><a href="real-data-examples.html"><i class="fa fa-check"></i><b>5</b> Real Data Examples</a><ul>
<li class="chapter" data-level="5.1" data-path="real-data-examples.html"><a href="real-data-examples.html#understanding-the-data"><i class="fa fa-check"></i><b>5.1</b> Understanding the data</a></li>
<li class="chapter" data-level="5.2" data-path="real-data-examples.html"><a href="real-data-examples.html#building-the-likelihood"><i class="fa fa-check"></i><b>5.2</b> Building the likelihood</a></li>
<li class="chapter" data-level="5.3" data-path="real-data-examples.html"><a href="real-data-examples.html#penalizing-the-likelihood-function"><i class="fa fa-check"></i><b>5.3</b> Penalizing the likelihood function</a></li>
<li class="chapter" data-level="5.4" data-path="real-data-examples.html"><a href="real-data-examples.html#reducing-granularity"><i class="fa fa-check"></i><b>5.4</b> Reducing granularity</a></li>
<li class="chapter" data-level="5.5" data-path="real-data-examples.html"><a href="real-data-examples.html#a-non-usual-likelihood-function"><i class="fa fa-check"></i><b>5.5</b> A non-usual likelihood function</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html"><i class="fa fa-check"></i><b>6</b> Considerations on performance</a><ul>
<li class="chapter" data-level="6.1" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html#benchmark-the-code"><i class="fa fa-check"></i><b>6.1</b> Benchmark the code</a></li>
<li class="chapter" data-level="6.2" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html#native-code"><i class="fa fa-check"></i><b>6.2</b> Native Code</a></li>
<li class="chapter" data-level="6.3" data-path="considerations-on-performance.html"><a href="considerations-on-performance.html#parallelization"><i class="fa fa-check"></i><b>6.3</b> Parallelization</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="accuracy-of-algorithms.html"><a href="accuracy-of-algorithms.html"><i class="fa fa-check"></i><b>7</b> Accuracy of algorithms</a><ul>
<li class="chapter" data-level="7.1" data-path="accuracy-of-algorithms.html"><a href="accuracy-of-algorithms.html#accuracy-of-estimates-for-the-berlin-dataset"><i class="fa fa-check"></i><b>7.1</b> Accuracy of estimates for the Berlin dataset</a></li>
<li class="chapter" data-level="7.2" data-path="accuracy-of-algorithms.html"><a href="accuracy-of-algorithms.html#accuracy-of-algorithms-using-different-algorithms"><i class="fa fa-check"></i><b>7.2</b> Accuracy of algorithms using different algorithms</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>8</b> Conclusion</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="package-usage.html"><a href="package-usage.html"><i class="fa fa-check"></i><b>A</b> Package Usage</a><ul>
<li class="chapter" data-level="A.1" data-path="package-usage.html"><a href="package-usage.html#installation"><i class="fa fa-check"></i><b>A.1</b> Installation</a></li>
<li class="chapter" data-level="A.2" data-path="package-usage.html"><a href="package-usage.html#usage"><i class="fa fa-check"></i><b>A.2</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="support-code.html"><a href="support-code.html"><i class="fa fa-check"></i><b>B</b> Support Code</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R Package for Change Point Detection</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="real-data-examples" class="section level1">
<h1><span class="header-section-number">5</span> Real Data Examples</h1>
<p>In order to exemplify how Segmentr is used in real situations, an example on weather
data is provided in this paper. The data was obtained using data found in <span class="citation">(Wetterdienst <a href="#ref-dwd" role="doc-biblioref">2019</a>)</span>.</p>
<p>Segmentr is a package that implements a handful of algorithms to segment a given data set, by finding
the change points that maximize the collective likelihood of the segments according to an arbitrary
likelihood function. So, the user of this package has to find an adequate likelihood for
the segmentation problem to be solved, possibly having to penalize it in order to avoid either an
overparametrized or underparametrized model, i.e. one with too many or too few change points,
respectively. Also, it’s important to consider the computation time of each algorithm and its
trade-offs. This example walks rough the main concepts regarding its usage, using historical
temperature data from Berlin as an example.</p>
<div id="understanding-the-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Understanding the data</h2>
<p>The <code>berlin</code> data set, provided in this package, contains daily temperature measurements
from 7 weather stations in Berlin for every day in the years 2010 and 2011,
i.e., a total of 730 days. Therefore, every element in the data set has a
temperature data point with units in Celsius, such that each of the 730 columns corresponds
to a date, and each of the 7 rows corresponds to the weather station the
data point was measured at. In Table <a href="real-data-examples.html#tab:berlin-sample">5.1</a>, it’s possible to see the first three
columns, as well as the last three columns, together with the respective stations.</p>
<table>
<caption>
<span id="tab:berlin-sample">Table 5.1: </span>
First and last columns of the <code>berlin</code> dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
station
</th>
<th style="text-align:right;">
2010-01-01
</th>
<th style="text-align:right;">
2010-01-02
</th>
<th style="text-align:right;">
2010-01-03
</th>
<th style="text-align:left;">
..
</th>
<th style="text-align:right;">
2011-12-29
</th>
<th style="text-align:right;">
2011-12-30
</th>
<th style="text-align:right;">
2011-12-31
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Buch
</td>
<td style="text-align:right;">
-1.6
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-4.8
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
2.1
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Dahlem (FU)
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-2.3
</td>
<td style="text-align:right;">
-4.5
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
5.2
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Kaniswall
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-2.0
</td>
<td style="text-align:right;">
-4.6
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
5.2
</td>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:right;">
1.9
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Marzahn
</td>
<td style="text-align:right;">
-1.8
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-4.8
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
5.7
</td>
<td style="text-align:right;">
3.7
</td>
<td style="text-align:right;">
2.6
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Schoenefeld
</td>
<td style="text-align:right;">
-1.9
</td>
<td style="text-align:right;">
-2.1
</td>
<td style="text-align:right;">
-4.6
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:right;">
2.4
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Tegel
</td>
<td style="text-align:right;">
-1.5
</td>
<td style="text-align:right;">
-2.0
</td>
<td style="text-align:right;">
-4.5
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
6.0
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
2.8
</td>
</tr>
<tr>
<td style="text-align:left;width: 5em; ">
Berlin-Tempelhof
</td>
<td style="text-align:right;">
-1.4
</td>
<td style="text-align:right;">
-1.7
</td>
<td style="text-align:right;">
-4.3
</td>
<td style="text-align:left;">
..
</td>
<td style="text-align:right;">
5.7
</td>
<td style="text-align:right;">
3.7
</td>
<td style="text-align:right;">
3.0
</td>
</tr>
</tbody>
</table>
<p>In order to grasp the behavior of the weather data, in Figure
<a href="real-data-examples.html#fig:berlin-curve">5.1</a> the daily average temperature of all the weather
stations, i.e., the mean value of each column in the data set as a time series
graph in order to observe how the average temperature of Berlin behaves over
time.</p>
<div class="figure"><span id="fig:berlin-curve"></span>
<img src="thesis_files/figure-html/berlin-curve-1.png" alt="Average daily temperature over time as measured by different stations in Berlin" width="672" />
<p class="caption">
Figure 5.1: Average daily temperature over time as measured by different stations in Berlin
</p>
</div>
<p>In the graph, the daily temperatures points alternate in upwards and downwards trends,
which suggests it’s possible to fit linear regressions for each of the upwards or downwards
trend segments. So, a “linear regression likelihood” function is proposed, which should
return a higher value the better a linear regression fits in a given segment. By intuition,
we expect the likelihood function to segment the dataset approximately to the way the vertical
lines are placed in Figure <a href="real-data-examples.html#fig:berlin-ideal">5.2</a>. The indices picked to represent each segment are available in Table <a href="real-data-examples.html#tab:berlinexpectedtable">5.2</a>.</p>
<div class="figure"><span id="fig:berlin-ideal"></span>
<img src="thesis_files/figure-html/berlin-ideal-1.png" alt="Manual segmentation of the weather data picked according to intuition" width="672" />
<p class="caption">
Figure 5.2: Manual segmentation of the weather data picked according to intuition
</p>
</div>
<table>
<caption>
<span id="tab:berlinexpectedtable">Table 5.2: </span>Expected values to be found when segmenting the Berlin dataset
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
199
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
569
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
570
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
</div>
<div id="building-the-likelihood" class="section level2">
<h2><span class="header-section-number">5.2</span> Building the likelihood</h2>
<p>An adequate likelihood function should be able to rank a given set of possible segments and pick
the best one given the evaluation criteria. Since the goal is to select segments with a good
linear regression fit, the method’s own standard log-likelihood function, i.e.
the negative of the squared sum of residuals, is a good candidate for our segment likelihood function.
However, the sum of
residuals tend to increase with the amount of points in a segment. Instead, we pick the negative mean of the
squared residuals, because it normalizes the likelihoods based on the length of the segment. So, in
Equation <a href="real-data-examples.html#eq:linear-regression-likelihood">(5.1)</a>, <span class="math inline">\(L_{lm}\)</span> is the linear regression likelihood function, <span class="math inline">\(X\)</span> is the set of points
that belong to the segment, <span class="math inline">\(x_i\)</span> and <span class="math inline">\(y_i\)</span> are the points that belong to <span class="math inline">\(X\)</span> for each index <span class="math inline">\(i\)</span>,
and <span class="math inline">\(f\)</span> is the best linear regression that fitted the <span class="math inline">\(X\)</span> segment.</p>
<p><span class="math display" id="eq:linear-regression-likelihood">\[\begin{equation}
L_{lm}(X)=-\sum_{i=1}^n\frac{1}{n}(y_i - f(x_i))^2
\tag{5.1}
\end{equation}\]</span></p>
<p>A likelihood argument for a <code>segment()</code> call requires a function which accepts
a candidate segment matrix, i.e. a subset of the columns in the data set, and
returns the estimated likelihood for the candidate. Therefore, equation
<a href="real-data-examples.html#eq:linear-regression-likelihood">(5.1)</a> is implemented as an R function called
<code>lm_likelihood</code>, such that it obeys the argument contract by taking a matrix as
argument and returning the negative mean of the squared residuals of a linear
regression over the candidate segment. In order to get a sense of how the function
behaves with the <code>berlin</code> data set, sample likelihoods a small, a medium,
and a large segment are provided in <a href="real-data-examples.html#tab:likelihood-samples">5.3</a>.</p>
<table>
<caption>
<span id="tab:likelihood-samples">Table 5.3: </span>Sample values of the linear regression
likelihood function for different sizes of segment
candidates
</caption>
<thead>
<tr>
<th style="text-align:right;">
Small Size
</th>
<th style="text-align:right;">
Medium Size
</th>
<th style="text-align:right;">
Large Size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.0283673
</td>
<td style="text-align:right;">
-12.18277
</td>
<td style="text-align:right;">
-68.85185
</td>
</tr>
</tbody>
</table>
<p>With the likelihood function defined, it can now be applied to <code>segment()</code> in
order to get the segments for the data set. Since the time complexity of the
exact algorithm is <span class="math inline">\(O(n^2)\)</span> and the number of points in the data set is high,
the execution time required for the computation is quite prohibitive. So, for
demonstration purposes, we use the hierarchical algorithm, due to its
<span class="math inline">\(O(n \log(n))\)</span>. We point the hierarchical algorithm, generally suitable for the
multivariate likelihood, assumes the segments’ likelihoods to be structured in
a hierarchical manner, with a combination of two neighboring segments having
being selected as an intermediate step before evaluating the ideal change
points of the data set. The segmentation results can be seen in Table
<a href="real-data-examples.html#tab:resultsnonpenalized">5.4</a>, and they are also plotted together with the
weather data in Figure <a href="real-data-examples.html#fig:berlin-non-penalized">5.3</a>.</p>
<table>
<caption>
<span id="tab:resultsnonpenalized">Table 5.4: </span>Results of the segmentation algorithm
using a non-penalized likelihood function
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
17
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
19
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
23
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
24
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
26
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
28
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
29
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
31
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
33
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
37
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
38
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
41
</td>
</tr>
<tr>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
47
</td>
</tr>
<tr>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:berlin-non-penalized"></span>
<img src="thesis_files/figure-html/berlin-non-penalized-1.png" alt="Berlin weather data segmented using a non-penalized likelihood function" width="672" />
<p class="caption">
Figure 5.3: Berlin weather data segmented using a non-penalized likelihood function
</p>
</div>
<p>In Figure <a href="real-data-examples.html#fig:berlin-non-penalized">5.3</a>, it’s possible see many very short
segments, and a very large last segment. This is a result of the algorithm
used, as well as the fact the <code>lm_likelihood</code> function tends to favor very
short segments, as they usually have smaller residual error. So, to not get
segments too short or too long, it’s necessary to penalize the likelihood
function for either extremely short or extremely long lengths.</p>
</div>
<div id="penalizing-the-likelihood-function" class="section level2">
<h2><span class="header-section-number">5.3</span> Penalizing the likelihood function</h2>
<p>To penalize a likelihood function in the Segmentr context is to decrease the return value of the likelihood
function whenever unwanted segments are provided as an input. Typically, this involves
penalizing the likelihood function whenever a very short or a very long segment is provided.</p>
<p>One such method is to subtract the output of the likelihood function with a penalty function which
is a function of the length of the segment. We propose a penalty function in <a href="real-data-examples.html#eq:penalty-function">(5.2)</a>.</p>
<p><span class="math display" id="eq:penalty-function">\[\begin{equation}
p(l) = C_1e^{s_1(l - \frac{L}{2})} + C_2e^{s_2(-l + \frac{L}{2})}
\tag{5.2}
\end{equation}\]</span></p>
<p>In equation <a href="real-data-examples.html#eq:penalty-function">(5.2)</a>, the penalty <span class="math inline">\(p(l)\)</span> is a function of the
segment’s length <span class="math inline">\(l\)</span>, has the property that, for parametrization values
<span class="math inline">\(C_1 &gt; 0\)</span>, <span class="math inline">\(s_1 &gt; 0\)</span>, <span class="math inline">\(C_2 &gt; 0\)</span> and <span class="math inline">\(s_2 &gt; 0\)</span>, the penalty is high for values of <span class="math inline">\(l\)</span>
neighboring <span class="math inline">\(0\)</span>, as well as values of <span class="math inline">\(l\)</span> the total length <span class="math inline">\(L\)</span> of the data set.
However, penalty is close to its minimum for values of <span class="math inline">\(l\)</span> neighboring
<span class="math inline">\(\frac{L}{2}\)</span>. To visualize, consider a sample penalty function, with <span class="math inline">\(C_1 = C_2 = 1\)</span>, <span class="math inline">\(s_1 = s_2 = 0.3\)</span> and <span class="math inline">\(L = 100\)</span>, plotted in Figure <a href="real-data-examples.html#fig:penalty-curve">5.4</a>.</p>
<div class="figure"><span id="fig:penalty-curve"></span>
<img src="thesis_files/figure-html/penalty-curve-1.png" alt="Example curve of the penalty function for $C_1 = C_2 = 1$, $s_1 = s_2 = 0.3$ and $L = 100$" width="672" />
<p class="caption">
Figure 5.4: Example curve of the penalty function for <span class="math inline">\(C_1 = C_2 = 1\)</span>, <span class="math inline">\(s_1 = s_2 = 0.3\)</span> and <span class="math inline">\(L = 100\)</span>
</p>
</div>
<p>Given the penalty function general formula, it’s necessary to adjust the
parameters such the penalty function has a scale compatible with the likelihood
function. The <code>auto_penalize()</code> function, provided in the Segmentr package,
builds a penalized version of the likelihood function, by estimating
parametrization values based on sample likelihood values for big and small
segments of the data set provided. The estimated parameters are tunable by
adjusting the <code>small_segment_penalty</code> and the <code>big_segment_penalty</code> parameters, depending
on how much small or big segments, respectively, should be penalized, i.e. the
higher the parameter, the more penalized the related type of segment size is.</p>
<p>Let <span class="math inline">\(P_s\)</span> be the <code>small_segment_penalty</code>, <span class="math inline">\(P_b\)</span> be the <code>big_segment_penalty</code>,
<span class="math inline">\(\mu_s\)</span> be the average likelihood for the sampled small segments and <span class="math inline">\(\mu_b\)</span> be
the average likelihood for the samples big segments. The relationship between
the parameters, as defined by the <code>auto_penalize()</code> function, is defined in
<a href="real-data-examples.html#eq:penalty-parametrization">(5.3)</a>.</p>
<p><span class="math display" id="eq:penalty-parametrization">\[\begin{equation}
\begin{aligned}
C_1 &amp; = \frac{\mu_b}{P_b} \\
s_1 &amp; = \frac{4 \log(P_b)}{L} \\
C_2 &amp; = \frac{\mu_s}{P_s} \\
s_2 &amp; = \frac{4 \log(P_s)}{L}
\end{aligned}
\tag{5.3}
\end{equation}\]</span></p>
<p>So, a penalized likelihood version of the function is created with
<code>auto_penalize()</code> and then used with <code>segment()</code>. The results of the
segmentation can be seen in Table <a href="real-data-examples.html#tab:resultsautopenalized">5.5</a>, and it’s
possible to the segments with the weather data in Figure
<a href="real-data-examples.html#fig:berlin-auto-penalized">5.5</a>.</p>
<table>
<caption>
<span id="tab:resultsautopenalized">Table 5.5: </span>Results of the segmentation algorithm
using an auto-penalized likelihood function
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
203
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
204
</td>
<td style="text-align:right;">
268
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
327
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
328
</td>
<td style="text-align:right;">
559
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
560
</td>
<td style="text-align:right;">
644
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
645
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:berlin-auto-penalized"></span>
<img src="thesis_files/figure-html/berlin-auto-penalized-1.png" alt="Berlin weather data segmented using an auto-penalized likelihood function" width="672" />
<p class="caption">
Figure 5.5: Berlin weather data segmented using an auto-penalized likelihood function
</p>
</div>
<p>The function above found two segments, the last of which was still quite large, which suggests the
<code>big_segment_penalty</code> argument needs to be increased to avoid that type of segment in the function.
So, by increasing it’s value, from the default of <span class="math inline">\(10\)</span>, all the way up to <span class="math inline">\(100\)</span>, we run the results
again with the <code>segment()</code> function. The results can be seen in <a href="real-data-examples.html#tab:resultsadjustedpenalized">5.6</a>,
and it’s possible to the segments with the weather data in Figure <a href="real-data-examples.html#fig:berlin-adjusted-penalized">5.6</a>.</p>
<table>
<caption>
<span id="tab:resultsadjustedpenalized">Table 5.6: </span>Results of the segmentation algorithm
using an adjusted penalized likelihood function
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
239
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
240
</td>
<td style="text-align:right;">
327
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
328
</td>
<td style="text-align:right;">
644
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
645
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:berlin-adjusted-penalized"></span>
<img src="thesis_files/figure-html/berlin-adjusted-penalized-1.png" alt="Berlin weather data segmented using an adjusted penalized likelihood function" width="672" />
<p class="caption">
Figure 5.6: Berlin weather data segmented using an adjusted penalized likelihood function
</p>
</div>
<p>Even with the new adjusted <code>penalized_likelihood</code>, the segments seen in Figure
<a href="real-data-examples.html#fig:berlin-adjusted-penalized">5.6</a> aren’t similar to what we are looking for as
shown in Figure <a href="real-data-examples.html#fig:berlin-ideal">5.2</a>. The reason behind this, as discussed
earlier. So, in order to segment the data ideally, it’s necessary to evaluate
all of the possibilities.</p>
<p>The exact algorithm does precisely compute all of the possibilities, but its <span class="math inline">\(O(n^2)\)</span> time complexity
is quite prohibitive to run the computation on the entire data set. So we can actually make the computation
tolerable by reducing the granularity of the data, getting the monthly averages for each of the
measurement stations.</p>
</div>
<div id="reducing-granularity" class="section level2">
<h2><span class="header-section-number">5.4</span> Reducing granularity</h2>
<p>The data set needs to be resampled in order to represent the monthly weather averages. It is done by
computing the average temperature for each combination of month and weather station. With the granularity reduction,
the data set will have 24 columns, one for each month in the two years period comprehended.
The plot of the monthly average temperature of the temperatures of all the data points is plotted in figure
<a href="real-data-examples.html#fig:downsampled-curve">5.7</a></p>
<div class="figure"><span id="fig:downsampled-curve"></span>
<img src="thesis_files/figure-html/downsampled-curve-1.png" alt="Average monthly temperature over time as measured by different stations in Berlin" width="672" />
<p class="caption">
Figure 5.7: Average monthly temperature over time as measured by different stations in Berlin
</p>
</div>
<p>A new <code>penalized_function</code> is then built and applied to the monthly data set
using <code>segment()</code>, with the results being shown in Table
<a href="real-data-examples.html#tab:downresautopenalized">5.7</a>, and with we also plot it with weather data
in Figure <a href="real-data-examples.html#fig:downsampled-auto-penalized">5.8</a>.</p>
<table>
<caption>
<span id="tab:downresautopenalized">Table 5.7: </span>Results of the segmentation algorithm
using an auto-penalized likelihood function over
downsampled berlin data
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
24
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:downsampled-auto-penalized"></span>
<img src="thesis_files/figure-html/downsampled-auto-penalized-1.png" alt="Downsampled Berlin monthly weather data segmented using an auto penalized likelihood function" width="672" />
<p class="caption">
Figure 5.8: Downsampled Berlin monthly weather data segmented using an auto penalized likelihood function
</p>
</div>
<p>In order to make the solution comparison clearer, it’s possible to
rescale the <code>exact</code> solution to the monthly sampled dataset to the
daily sampled dataset by applying a linear transformation of
multiplying all the change points for the number of columns in the
daily dataset and dividing it by the number of columns in the
monthly dataset, i.e. each rescaled change point <span class="math inline">\(C_i\)</span> relates to
the original change point <span class="math inline">\(c_i\)</span> as described in equation
<a href="real-data-examples.html#eq:rescaled-change-points">(5.4)</a>, in which <span class="math inline">\(i\)</span> is the index of
each change point estimated with the monthly data set, <span class="math inline">\(N_M\)</span>
represents the number of columns in the monthly Berlin weather
data set and <span class="math inline">\(N_B\)</span> represents the number of columns in the daily
Berlin data set, in the original form provided by the Segmentr
package.</p>
<p><span class="math display" id="eq:rescaled-change-points">\[\begin{equation}
C_i = \left \lfloor{c_i \frac{N_B}{N_M}} \right \rfloor
\tag{5.4}
\end{equation}\]</span></p>
<p>After applying that transformation, the results can be seen in
Table <a href="real-data-examples.html#tab:resultsrescaled">5.8</a>, as well as the plot along with
the daily graph in Figure <a href="real-data-examples.html#fig:plot-results-rescaled">5.9</a></p>
<table>
<caption>
<span id="tab:resultsrescaled">Table 5.8: </span>Results of the segmentation algorithm
using an auto-penalized likelihood function over
downsampled berlin data, but rescaled to fit the
original data dimensions
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
212
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
213
</td>
<td style="text-align:right;">
364
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
577
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
578
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:plot-results-rescaled"></span>
<img src="thesis_files/figure-html/plot-results-rescaled-1.png" alt="Rescaled segments estimated for a downsampled monthly weather data of the Berlin data set using an auto penalized likelihood function" width="672" />
<p class="caption">
Figure 5.9: Rescaled segments estimated for a downsampled monthly weather data of the Berlin data set using an auto penalized likelihood function
</p>
</div>
<p>With the exact solution, made possible with the granularity reduction, we
noticed the data set is segmented closer to what the ideal solution would be,
as the algorithm as able to evaluate all of the possibilities.</p>
</div>
<div id="a-non-usual-likelihood-function" class="section level2">
<h2><span class="header-section-number">5.5</span> A non-usual likelihood function</h2>
<p>Take notice the picking of the likelihood just have be able to rank segments in
a desired manner. Therefore, there’s freedom to pick a non-conventional
likelihood function. For example, the R-squared statistic of the linear
regression in each segment is conventionally used to infer how well the linear
model fits the points in the data. It ranges from zero to one and the closer it
is to one, the better it predicts the points in the data. Therefore, we propose
the implementation of a <code>rsquared_likelihood</code>, which fits a linear regression
against the data set received as input in the function, and then returns the
R-squared statistic as the “likelihood” value of the segment. The defined
function is applied against different segment sizes of the <code>berlin</code> data set,
analogous to Table <a href="real-data-examples.html#tab:likelihood-samples">5.3</a>, and the results are shown in
<a href="real-data-examples.html#tab:rsquared-samples">5.9</a>.</p>
<table>
<caption>
<span id="tab:rsquared-samples">Table 5.9: </span>Sample values of the R-squared
likelihood function for different sizes of segment
candidates
</caption>
<thead>
<tr>
<th style="text-align:right;">
Small Size
</th>
<th style="text-align:right;">
Medium Size
</th>
<th style="text-align:right;">
Large Size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.982116
</td>
<td style="text-align:right;">
0.7601494
</td>
<td style="text-align:right;">
0.0328304
</td>
</tr>
</tbody>
</table>
<p>From what is observed in Table <a href="real-data-examples.html#tab:rsquared-samples">5.9</a>, and similar to the
previous case, the new <code>rsquared_likelihood</code> has the highest values for small
segments. Therefore, it needs to be penalized with the <code>auto_penalize</code>
function. We then go on and apply the results of the penalized function and show
them in Table <a href="real-data-examples.html#tab:rsquaredres-auto-penalized">5.10</a>. The plot with the weather
data can be seen in Figure <a href="real-data-examples.html#fig:rsquaredplot-auto-penalized">5.10</a>.</p>
<table>
<caption>
<span id="tab:rsquaredres-auto-penalized">Table 5.10: </span>Results of the segmentation algorithm
using an auto-penalized R-squared likelihood function over
Berlin data
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
268
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
269
</td>
<td style="text-align:right;">
550
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
551
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:rsquaredplot-auto-penalized"></span>
<img src="thesis_files/figure-html/rsquaredplot-auto-penalized-1.png" alt="Berlin daily weather data segmented using an auto-penalized R-squared likelihood function" width="672" />
<p class="caption">
Figure 5.10: Berlin daily weather data segmented using an auto-penalized R-squared likelihood function
</p>
</div>
<p>The default penalized <code>rsquared_likelihood</code> split the data set in three
segments, roughly the same size each. Since the penalty model applied by
<code>auto_penalize</code>, it applies the least penalty for values segments closer to
about half the total length, so increasing the <code>big_penalty_segment</code> will have
no effect. In fact, smaller segments are being over penalized. Because of this,
it’s necessary to reduce the <code>small_segment_penalty</code> segment, which we decrease
to <span class="math inline">\(1.5\)</span>, from the default of <span class="math inline">\(10\)</span>. The results of the new segmentation can be
seen in Table <a href="real-data-examples.html#tab:rsquaredres-adjusted-penalized">5.11</a>, and the plot in Figure
<a href="real-data-examples.html#fig:rsquaredplot-adjusted-penalized">5.11</a>.</p>
<table>
<caption>
<span id="tab:rsquaredres-adjusted-penalized">Table 5.11: </span>Results of the segmentation algorithm
using an adjusted penalized R-squared likelihood
function over Berlin data
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
237
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
238
</td>
<td style="text-align:right;">
364
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
366
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
367
</td>
<td style="text-align:right;">
587
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
588
</td>
<td style="text-align:right;">
724
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
725
</td>
<td style="text-align:right;">
730
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:rsquaredplot-adjusted-penalized"></span>
<img src="thesis_files/figure-html/rsquaredplot-adjusted-penalized-1.png" alt="Berlin daily weather data segmented using an adjusted penalized R-squared likelihood function" width="672" />
<p class="caption">
Figure 5.11: Berlin daily weather data segmented using an adjusted penalized R-squared likelihood function
</p>
</div>
<p>With the adjusted parameters, we see the <code>rsquared_penalized</code> was able to
segment the data in Figure <a href="real-data-examples.html#fig:rsquaredplot-adjusted-penalized">5.11</a> in a
seemingly accurate manner, despite the nature of the hierarchical algorithm. As
discussed previously, we point the hierarchical algorithm is not adequate for
the linear likelihood, as the grouping of neighboring segments under a
macro-segment, an intermediate segment state under the hierarchical algorithm,
has a unattractive likelihood, due to the presence of alternating trends.
Because of this, the macro-segment is never picked by the algorithm during the
computation process, and so the ideal change points are never picked at their
ideal positions. In order to see it more clearly, take the first 547 data
points of the Berlin data set, roughly one year and a half. The results
of the segmentation with that portion of the <code>berlin</code> data set can be seen in
Table <a href="real-data-examples.html#tab:subberlinres-penalized">5.12</a>, and the plot can be seen in Figure
<a href="real-data-examples.html#fig:subberlinplot-penalized">5.12</a>.</p>
<table>
<caption>
<span id="tab:subberlinres-penalized">Table 5.12: </span>Results of the segmentation algorithm
using an auto-penalized R-squared likelihood
function over a subset of Berlin data
</caption>
<thead>
<tr>
<th style="text-align:right;">
Segment no.
</th>
<th style="text-align:right;">
First index
</th>
<th style="text-align:right;">
Last index
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
178
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
179
</td>
<td style="text-align:right;">
282
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
283
</td>
<td style="text-align:right;">
547
</td>
</tr>
</tbody>
</table>
<div class="figure"><span id="fig:subberlinplot-penalized"></span>
<img src="thesis_files/figure-html/subberlinplot-penalized-1.png" alt="Subset of Berlin daily weather data segmented using an auto-penalized R-squared likelihood function" width="672" />
<p class="caption">
Figure 5.12: Subset of Berlin daily weather data segmented using an auto-penalized R-squared likelihood function
</p>
</div>
<p>In Figure <a href="real-data-examples.html#fig:subberlinplot-penalized">5.12</a>, we can clearly see the segments
do not match our expectations, as the algorithm is not able to bisect a
macro-segment before finding the ideal segments in the next algorithm
iteration.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-dwd">
<p>Wetterdienst, Deutscher. 2019. “Climate Data Center - Ftp Server.” <a href="https://www.dwd.de/EN/climate_environment/cdc/cdc.html">https://www.dwd.de/EN/climate_environment/cdc/cdc.html</a>; Deutscher Wetterdienst.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="considerations-on-performance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["thesis.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
