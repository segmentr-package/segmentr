<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Thales Mello" />

<meta name="date" content="2019-01-29" />

<title>Segmenting data with segmentr</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Segmenting data with segmentr</h1>
<h4 class="author"><em>Thales Mello</em></h4>
<h4 class="date"><em>2019-01-29</em></h4>



<p>Segmentr is a package that implements a handful of algorithms to find segments that maximize its total likelihood. So, the user of this package has to find an adequate likelihood for the segmentation problem to be solved, possibly having to penalize it in order to avoid either an overparameterized or underparameterized model, i.e. one with too many or too few change points. Also, it’s important to consider the computation time of each algorithm and its tradeoffs. This <em>vignette</em> walks rough the main concepts regarding its usage, using weather temperature from Berlin as an example. For this demo, the following packages will be used:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">require</span>(segmentr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">require</span>(tidyr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">require</span>(tibble)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">require</span>(dplyr)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">require</span>(lubridate)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">require</span>(magrittr)</a></code></pre></div>
<div id="understanding-the-data" class="section level2">
<h2>Understanding the data</h2>
<p>The <code>berlin</code> dataset, provided in this package, contains daily temperature measurements from 7 weather stations in Berlin for every day in the years 2010 and 2011, i.e., a total of 730. Therefore, every element in the <code>berlin</code> has a temperature measumement in ºC, such that each of the 730 columns corresponds to a date and each of the 7 rows corresponds to the weather station the measurement was collected from. In the table below, it’s possible to see the first five columns of measurements and the respective weather stations.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">data</span>(berlin)</a>
<a class="sourceLine" id="cb2-2" title="2">berlin[, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt;                    2010-01-01 2010-01-02 2010-01-03 2010-01-04 2010-01-05</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; Berlin-Buch              -1.6       -1.9       -4.8       -6.2       -6.1</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt; Berlin-Dahlem (FU)       -1.9       -2.3       -4.5       -6.2       -6.8</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; Berlin-Kaniswall         -1.9       -2.0       -4.6       -6.6       -7.7</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; Berlin-Marzahn           -1.8       -1.9       -4.8       -6.2       -6.2</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; Berlin-Schoenefeld       -1.9       -2.1       -4.6       -6.5       -7.0</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; Berlin-Tegel             -1.5       -2.0       -4.5       -6.0       -5.5</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; Berlin-Tempelhof         -1.4       -1.7       -4.3       -5.6       -6.0</span></a></code></pre></div>
<p>In order to visualize the data, plot the daily average temperature of all the weather stations, i.e., the mean value of each column in the <code>berlin</code> dataset, with its respective date in order to observe how the average temperature of berlin behaves over time.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">berlin <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="st">  </span><span class="kw">colMeans</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">enframe</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;temperature&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(time), ymd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span><span class="kw">with</span>(<span class="kw">plot</span>(time, temperature))</a></code></pre></div>
<p><img src="data:image/png;base64,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KgJYQsvy1gPW7isDPM6AyvCWvIyOQEUR8CFYRV+sV8sRKAMCzoDK8Ja8jI5ARRFwBlTRF+vVcgTKgIAzoDK8JS+jI1BRBJwBVfTFerUcgTIg4AyoDG/Jy+gIVBQBZ0AVfbFeLUegDAg4AyrDW/IyOgIVRcAZUEVfrFfLESgDAs6AyvCWvIyOQEURcAY0yIt95ZVXBjn7n1MsvZNHL7/8cnjxxRcHzdbMfQa9QQ+dbBduVOmFF17IrVkzeXJv0iMZ2oUd7Y1214iaeU6ja9uZ7gwog+bzzz+vq5aytvviiy8eVltttXDyySeHf//73zU5Z86cGVj9dKmllgobb7xxmD17ds15O+BF23LMlmZblu/5whe+oA6YK6ywQth1113DE088YadLt73sssvCeuutF5ZYYolAfT760Y/qUjtxRVj9gsUaWcNq9dVXDyeeeGJ8umb/oosuCq973etq0rIHzeTJXtNrx/fcc08YM2aMrjFHe9pwww3DTTfdVFPMobSVBx54INB+WSIqS828o+w1HT2WL69ThMC4ceMS6RzJlClTkttvvz2R5XUSYUSJrGaa5vrJT36SyNrvydlnn51Ih0r222+/RNZ+T37zm9+kedgRD289Jy8wGT9+fM05DmT11ESWUkmksSXcUxaQS97znvckwrQG5O31hOuvvx5RUOspzDiZPn16Igwmeec735nIooNafGHumrbHHnskv/rVr5KLL744kQ6XnHTSSQOqd/XVVyvGSy655IBzltBMHsvbq1v54CRvetObElnoMvnmN7+ZyPI6yQ477JDIIpbJvHnz0mI321buv//+RD4C+i5kUcL0enaaeUc1F3ThgNU7nf6LwNNPP50suuiiyRFHHFGDyW677ZZIeI00be21107kK54es8NLnzBhQpr2y1/+MllnnXWS5ZZbTq/NMqC77rpLn3XNNdek18iXUBuOfLnStLLsbLfddokshFfDPGfNmqX1gblCkydPTmQl2USGTGm1jj/++ESkHGXWJD7zzDOKLcxMVpFN6jGgZvKkD+jxnQsvvFAx+sUvfpGWlPotvfTSyQEHHKBpzbaVc889N5E16RJZebcuA2rmHaWF6NKOD8Ei+ZIx83nnnRc++9nPRqlBY638/e9/16WWWb3z3nvvDbvssktNHlam/N73vpemzZgxI8iXLTDkYKiRJURskaLC9ttv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" /><!-- --></p>
<p>From the visualization, alternating upwards and downwards trends are recognizable in the graph, which implies segments with optimal regressed linear models can be identified in the dataset. In order to accomplish data, a “linear regression likelihood” function is proposed, which is desired to maximize the likelihood of segments with a good linear regretion.</p>
</div>
<div id="building-the-likelihood" class="section level2">
<h2>Building the likelihood</h2>
<p>To build an adequate likelihood function that uses a linear regression, it’s necessary to find a metric that is higher the better fit a segment is, for which the the of the squared residuals of the regressed model, the usual likelihood function for linear regressions, has the desired characteristics. It will maximize the likelihood for a segment with the optimal linear regression.</p>
<p>A [segment()] likelihood argument requires a function which accepts a candidate segment matrix, i.e. a subset of the columns in the dataset, and returns the estimated likelihood for the candidate. Therefore, the <code>lm_likelihood</code> function implementation is provided below, one which obeys the contract by taking a matrix as argument and returning the sum of the squared residuals of a linear regression over the candidate segment.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># berlin dataset is transformed into a dataframe, which will</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># be used as cache to avoid repeated conversions and improve performance</span></a>
<a class="sourceLine" id="cb4-3" title="3">berlin_dataset_cache &lt;-<span class="st"> </span><span class="kw">t</span>(berlin) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">  </span><span class="kw">as_tibble</span>(<span class="dt">rownames=</span><span class="st">&quot;time&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(time), ymd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="st">  </span><span class="kw">rowid_to_column</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="st">  </span><span class="kw">gather</span>(station, temperature, <span class="op">-</span>rowid, <span class="op">-</span>time)</a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">lm_likelihood &lt;-<span class="st"> </span><span class="cf">function</span> (data) {</a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="cf">if</span>(<span class="kw">ncol</span>(data) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">return</span>(<span class="op">-</span><span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb4-11" title="11">  dates &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="kw">colnames</span>(data))</a>
<a class="sourceLine" id="cb4-12" title="12">  start_date &lt;-<span class="st"> </span><span class="kw">head</span>(dates, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-13" title="13">  end_date &lt;-<span class="st"> </span><span class="kw">tail</span>(dates, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-14" title="14">  </a>
<a class="sourceLine" id="cb4-15" title="15">  fit &lt;-<span class="st"> </span>berlin_dataset_cache <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="st">    </span><span class="kw">filter</span>(start_date <span class="op">&lt;=</span><span class="st"> </span>time <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span>end_date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="st">    </span><span class="kw">with</span>(<span class="kw">lm</span>(temperature <span class="op">~</span><span class="st"> </span>rowid))</a>
<a class="sourceLine" id="cb4-18" title="18">    </a>
<a class="sourceLine" id="cb4-19" title="19">  <span class="kw">sum</span>(fit<span class="op">$</span>residuals <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-20" title="20">}</a>
<a class="sourceLine" id="cb4-21" title="21"></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="kw">c</span>(<span class="kw">lm_likelihood</span>(berlin[, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]), <span class="kw">lm_likelihood</span>(berlin[, <span class="dv">1</span><span class="op">:</span><span class="dv">150</span>]), <span class="kw">lm_likelihood</span>(berlin))</a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt; [1] 3.971429e-01 1.279191e+04 3.518329e+05</span></a></code></pre></div>
<p>The <code>lm_likelihood</code> function returns a low value when compared to a hypothetical slice of the first 150 columns, so it appears reasonable. However, the highest likelihood was obtained with a segment of size 2, which indicates this function has a tendency to favor small data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">make_cumulative &lt;-<span class="st"> </span><span class="cf">function</span>(likelihood) {</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="kw">Vectorize</span>(. <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">floor</span>() <span class="op">%&gt;%</span><span class="st"> </span>{ berlin[, <span class="dv">1</span><span class="op">:</span>., drop =<span class="st"> </span><span class="ot">FALSE</span>] } <span class="op">%&gt;%</span><span class="st"> </span>lm_likelihood)</a>
<a class="sourceLine" id="cb5-3" title="3">}</a>
<a class="sourceLine" id="cb5-4" title="4">f &lt;-<span class="st"> </span><span class="kw">make_cumulative</span>(lm_likelihood)</a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">curve</span>(f, <span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">730</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This graph represents how the likelihood of the first <span class="math inline">\(x\)</span> segments in the data, and one can see the curve has a peak close to zero. Even though it’s not the global maximum of the curve, the cumulative effect of all the segments in the data is enough to bias the solution towards small segments.</p>
</div>
<div id="penalizing-the-likelihood-function" class="section level2">
<h2>Penalizing the likelihood function</h2>
<p>To penalize small segments, it’s important to penalize the likelihood function to avoid non-wanted behavior. Segmentr provides the <code>auto_penalize</code> utility, which returns a penalized version of the likelihood function.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">f_lm &lt;-<span class="st"> </span><span class="kw">make_cumulative</span>(lm_likelihood)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">curve</span>(f_lm, <span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">730</span>)</a>
<a class="sourceLine" id="cb6-3" title="3">penalized_likelihood &lt;-<span class="st"> </span><span class="kw">auto_penalize</span>(berlin, lm_likelihood)</a>
<a class="sourceLine" id="cb6-4" title="4">f_penalized &lt;-<span class="st"> </span><span class="kw">make_cumulative</span>(penalized_likelihood)</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="kw">curve</span>(f_penalized, <span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">730</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The new likelihood curve penalizes segments too big or too small, indicating it might work as we expect.</p>
</div>
<div id="segmenting-the-data" class="section level2">
<h2>Segmenting the data</h2>
<p>With the penalized likelihood at hand, it’s finally possible to segment the data. For that, the “hierarchical” algorithm will be used, which manages to segment the data in a reasonable <span class="math inline">\(O(n \log(n))\)</span> time complexity, by assuming the data to have a hierarchical structure. It returns reasonable results most of the times, but there is always the risk it doesn’t split the data correctly. To find the exact answer, the “exact” algorithm would have to be used, but it’s quite costly with <span class="math inline">\(O(n^2)\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">results &lt;-<span class="st"> </span><span class="kw">segment</span>(</a>
<a class="sourceLine" id="cb7-2" title="2">  berlin,</a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="dt">likelihood =</span> penalized_likelihood,</a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="dt">algorithm =</span> <span class="st">&quot;hierarchical&quot;</span></a>
<a class="sourceLine" id="cb7-5" title="5">)</a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7">results</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; Segments (total of 4):</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; 1:371</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; 372:376</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; 377:384</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; 385:730</span></a></code></pre></div>
<p>It looks the segments are still rather large, so the penalty on small segments might be too large. The penalty function can be tuned to adjust it.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">penalized_likelihood &lt;-<span class="st"> </span><span class="kw">auto_penalize</span>(berlin, lm_likelihood, <span class="dt">big_segment_penalty =</span> <span class="dv">10</span>, <span class="dt">small_segment_penalty =</span> <span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3">results &lt;-<span class="st"> </span><span class="kw">segment</span>(</a>
<a class="sourceLine" id="cb8-4" title="4">  berlin,</a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="dt">likelihood =</span> penalized_likelihood,</a>
<a class="sourceLine" id="cb8-6" title="6">  <span class="dt">algorithm =</span> <span class="st">&quot;hierarchical&quot;</span></a>
<a class="sourceLine" id="cb8-7" title="7">)</a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9">results</a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; Segments (total of 4):</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; 1:371</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; 372:376</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; 377:384</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt; 385:730</span></a></code></pre></div>
<p>Plot the actual change points on the daily means to have a better understanding of how the segments split the data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">dates &lt;-<span class="st"> </span><span class="kw">colnames</span>(berlin) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ymd</span>()</a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3">berlin <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="st">  </span><span class="kw">colMeans</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="st">  </span><span class="kw">enframe</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;temperature&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(time), ymd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="st">  </span><span class="kw">with</span>({</a>
<a class="sourceLine" id="cb9-8" title="8">    <span class="kw">plot</span>(time, temperature, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb9-9" title="9">    <span class="kw">abline</span>(<span class="dt">v=</span>dates[results<span class="op">$</span>changepoints], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-10" title="10">  })</a></code></pre></div>
<p><img src="data:image/png;base64,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CIiAUoNeAQsBISACUh4QAkIgNQREQKlBr4CFgBAQASkPCAEhkBoCIqDUoFfAQkAIiICUB4SAEEgNARFQatArYCEgBERAygNCQAikhoAIKDXoFbAQEAIiIOUBISAEUkNABJQa9ApYCAiBzBNQLpdzH330kfv000/1NYWAEMgYApkkoPfee8+dccYZrkuXLm6++eZzyy23nFt66aXd4osv7jbeeGN3yimnuH//+98Z+xSKrhDoeAh0ijSIXJaSPX36dLfNNtu4Tp06uQMPPNCtscYabqmllvLHaEFvv/22u/322x3J+tvf/ubWXHPNLCVPcRUCHQqBzBHQCSec4F588UX317/+1c0///xFP9b333/v9thjD7f11lu7888/v+g9OikEhED6CMyTfhRaF4NJkya5Pn36lCQf3jbvvPO6ww47zF155ZVVI6ArrrjCDR8+3Df7WpcC3d0SAovOnBlpr85927nJLTR7tvtqnsxl0ZaSV9NrCyywgBszZoxbdNFFaxpuawLL3Nft3r27e+qpp9xRRx3VYjofffRRt/LKK7d4T3su/vGPf3S//e1vRUDtAbHIsxvv1dPNWmRhN/2UAW71wcPc5HtHF7lLp8pBYIcddnBvvfWWt4uWc38a92SOgH7+8587SOhf//qXO+SQQ7yNBwN0U1OT7wmbNm2au/nmm90DDzzgm2nVAnWeqGZebLHF3JZbblmtIDrke2fON6+bN6q511t/PTd7/vmEbztywQ9/+MN2PF2bRzNHQJtssombPHmy69evn2+KzY7U9LjsvPPO7pFHHnHbbbdd/FLi8YwZM9wbb7yReB9d/5988knifbpBCAiB0ghkjoBIylprreV7uL777jv3zjvvOLQeDM8rrbSSW2WVVXyXfOkkt3zlueeec0OGDGn5pugqvW3PP/+869GjR+K99XYD5AnJbrXVVvUWNcWngyGQSQKyb4QPEGTED5k1a5b78MMP7XKbtnvuuafjlyQY9iC8LMrAgQPduHHjvCZZb/FvGjbE5SIXC7fOOq5p6KB6i57iU2EEMumICMlYD9fUqVM9JOeee65bYYUVvAYEMdxzzz0VhqpxXofWSE9hPUpT716u86GHuKYfrOKaoq2ksRHInAYE+eDfQyFCA7r88svdsGHD3EUXXeT2339/161bN/enP/3J748fP9517dq1sb9gG1L3/vvv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ubFfxzpfRxxxhHvhhRcaO6FVSB3zYT388MNlDaKuQvDtemXD2IDahYIeFgJCIBUERECpwK5AhYAQAAERkPKBEBACqSEgAkoNegUsBISACEh5QAgIgdQQEAGlBr0CFgJCQASkPCAEhEBqCIiAUoNeAQsBISBHxArnAdasZ7L15ZZbrsJvbuzX4Qn97rvvurXXXruxE1qF1OEJvfrqqxdM7l+FYKryShFQVWDVS4WAECgHATXBykFJ9wgBIVAVBERAVYFVLxUCQqAcBERA5aCke4SAEKgKAiKgqsCqlwoBIVAOAiKgclDSPUJACFQFARFQVWDVS4WAECgHARFQOSjpHiEgBKqCgAioKrDqpUJACJSDgAioHJR0jxAQAlVBQARUFVj1UiEgBMpBQATUAkqzZ89u4eqcS+UsKjJr1iz33Xfftfiuct7T4gvq6GKlcCNJ3377bWLKyrkn8SV1ckOlsCO/ke9KSTnhlHq2kudFQDE0v/76a3fqqae6lVZayS+5s9pqq7mhQ4e6mTNnFtx54403uu23394ttNBCbvPNN3ePP/54wXU74EPvs88+7uijo/XOY8LyPWeccYYfgLnUUku5nj17uk+itbCyKrfccovbcMMN3fzzz+9Iz0EHHeSX2gnTw+oXhxxyiF/Dao011nAXROt/lZI//OEPbplllil12Z8v554WX1AHF19++WXH8t2LLbaYz09du3Z1f/nLXwpi1pq88vbbb/v8yxJRcSnnG8Wfqeox64JJ5iLQu3fvXLSoYG7IkCG5cePG5aLldXLzzDNPbuDAgfmbnnjiidx8882Xu/LKK3NRgcodc8wxuQUWWCD34osv5u9hJxrh7a9FHzDXp0+fgmsc9O/fP7fmmmvmosyW450bb7xxbpNNNslFpNXs3no/MWbMGNaX8+mMyDh37bXX5iKCyW200Ua5aNFBH/2I3P25gw8+OBctv5O74YYbchGB5wYPHtwseXfddZfHeMEFF2x2zU6Uc4/dW6/bqMLJrbzyyrlNN900d/PNN+ei5XVye+21V27eeefNPf/88/lol5tX3nrrrVxUCfhvcd999+WfZ6ecb1TwQA0OorXfJIbA559/nmtqasqddtppdspv999//1w0vUb+3HrrrZeLavH8MTt89MMPPzx/7rnnnsutv/76uSWWWMI/GyegyZMn+7Duvvvu/DNRTegz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" /><!-- --></p>
<p>They more or less split the data as expected.</p>
</div>
<div id="limitations-of-the-hierarchical-algorithm" class="section level2">
<h2>Limitations of the “hierarchical” algorithm</h2>
<p>Even though it runs fast, the “hierarchical” algorithm should be handled with care, because it assumes the data has a hierarchical segment structure, which is not always true. To give an example, a subset of the <code>berlin</code> dataset is used.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">sub_berlin &lt;-<span class="st"> </span>berlin[, <span class="dv">1</span><span class="op">:</span><span class="dv">551</span>]</a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3">results &lt;-<span class="st"> </span><span class="kw">segment</span>(</a>
<a class="sourceLine" id="cb10-4" title="4">  sub_berlin,</a>
<a class="sourceLine" id="cb10-5" title="5">  <span class="dt">likelihood =</span> penalized_likelihood,</a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="dt">algorithm =</span> <span class="st">&quot;hierarchical&quot;</span></a>
<a class="sourceLine" id="cb10-7" title="7">)</a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9">results</a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt; Segments (total of 3):</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt; 1:371</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; 372:484</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; 485:551</span></a></code></pre></div>
<p>The “hierarchical” algorithm only splits the data in half in this situations. This happens because it first tries to find a optimal change point in the data, so that it can recursively find the remainder.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">sub_berlin <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">colMeans</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">enframe</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;temperature&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(time), ymd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">with</span>({</a>
<a class="sourceLine" id="cb11-6" title="6">    <span class="kw">plot</span>(time, temperature, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</a>
<a class="sourceLine" id="cb11-7" title="7">    <span class="kw">abline</span>(<span class="dt">v=</span>dates[results<span class="op">$</span>changepoints], <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-8" title="8">  })</a></code></pre></div>
<p><img src="data:image/png;base64,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DQERUGrQK2EhIAREQKoDQkAIpIaACCg16JWwEBACIiDVASEgBFJDQASUGvRKWAgIARGQ6oAQEAKpISACSg16JSwEhIAISHVACAiB1BAQAaUGvRIWAkJABKQ6IASEQGoIiIBSg14JCwEhkHkCyuVy7uOPP3b/+c9/VJpCQAhkDIFMEtC7777rjjnmGNerVy8322yzuUUWWcQtuOCCbr755nN9+vRxRxxxhPvvf/+bsaJQdoVA6yHQFmkQuSy99ptvvuk23HBD19bW5nbddVe3zDLLuB49evjfaEGvv/66u/766x2vde+997pll102S6+nvAqBlkIgcwR08MEHu2eeecb9/e9/d7PPPnvBwvruu+/cwIED3QYbbOCGDx9eMIwuCgEhkD4Cs6Sfhc7l4Omnn3b77rtvUfIhtllnndUNGjTIXXDBBTUjoPPPP9+NHTvWd/s69wYK3QgIzPvdNPfFrOlV/x9Nm+a+6t7d5SJNvlYyxxxzuFtvvdXNM888tUqiy/GmVwIVZn399dd3Dz/8sNt///1LxnDfffe5JZZYomSYrty84oor3LnnnisC6gqIKT67Zt9+7qmH73OuWzpm0FV+vpd7efRp7n9LLVkzFPr37+9ee+01bxetWSJdjDhzBLTHHns4SOjDDz90e+65p7fxYIDuFlUkbEBvvPGGu/LKK90dd9zhu2ldxKfo47PMMoubd9553XrrrVc0jG40LgLTIsVj3ajs2lIioGlzzuFWW2011/aT5WsG0vLL1y7uamU6cwREoT377LPugAMO8F2xGTNmdMBis802c3fffbfbZJNNOtxLuvDRRx+5V155JSmYH/r/9NNPE8MpgBAQAsURyBwB8SrLLbecH+GaOnWqe+utt7zWg+F58cUXd//3f//nh+SLv3LpO08++aQbNWpU6UDRXUbbnnrqKbfNNtskhm2WAHRr11577Ya2KTQL1q3yHpkkICscfIAgI/6Q6dOnuw8++MBuV3TceuutHX9JgmEPwmsVYeRxwIAB7p133mkKAup24fmpdb+oM91OOcm5RXu2SvUp+p7pWOCKZqe8G5CMjXC98MIL/qGTTz7ZLbrool4Dghhuvvnm8iJTqLIQMJzROptBug0dkuprdNt9N9cWOc62umROA4J88O+h64UGdN5557kzzzzTnXXWWW7nnXf2XYQ///nP/vyxxx5za621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bW1t+ewMHjw4f64TIRAioC5YiIbOu4zAIYcc4u6//3730EMPubXWWsu9//77btSoUW6vvfbKx73JJpu4O++806EpoRn16dPHXXPNNe6rr77yWlPPnj3dNtts4+677778M5w899xzbosttnA9evRwvXv3dscff7z77rvv2oXRj2whIALKVnk1fG532GEHt8wyy7hevXq5Qw891M0777zuzTffdJMnT87n/emnn3ZoRR9//LE79dRT3dxzz+32228/t/nmm7spU6a4008/3d/DdmTC8+uuu6777LPP3Nlnn+2OOuood8kll7h99tnHguiYQQTUBctgoTVylgcMGOCWXHJJN3XqVLf33nsXzeriiy/urrvuOte9e3e3xhpreCM1z9x8883+mVVWWcUTzgsvvOBWWGEFd+KJJ7q55prLa1azzz67D7Pgggu6XXbZxZMRcUiyh4AIKHtl1hQ5Xn/99T358DKQDbL11lv7I/8gKOTVV1/1BPTggw+6DTbYwD311FP+Ov/mm28+161bN/fYY495Esvf0ElmEBABZaaomiujRjC8FVoQstRSS/kj/+wa519//bVjaP+WW27xf1wL5Y033gh/6jxDCIiAMlRYzZTVWWYpv+rNOeecjr+DDjrIjR49ugMM4Yhbh5u60NAIyAjd0MWTzcxBCNOnT69a5olvpZVWctdee62Pk9/8vfTSSw6b06OPPlq1tBRRfREQAdUX75ZIbZ555nHPP/+8u+uuu/zQejVe+oQTTnBvv/22Hz2bNGmSmzhxoh85YyRt7bXXrkYSiiMFBERAKYDe7EkyNP7FF1+4rbbayk2YMKEqr7vjjju6iy++2N16661u5ZVX9gbpBRZYwI0bN851pjtXlcwokqoh0JaLpGqxKSIh8AMCVCt8dnAarLa89dZbbuGFF/Z2oWrHrfjqi4AIqL54KzUhIAQCBNQFC8DQqRAQAvVFQARUX7yVmhAQAgECIqAADJ0KASFQXwREQPXFW6kJASEQICACCsDQqRAQAvVFQARUX7yVmhAQAgECIqAADJ0KASFQXwREQPXFW6kJASEQICACCsDQqRAQAvVFQARUX7yVmhAQAgECIqAADJ0KASFQXwREQPXFW6kJASEQICACCsDQqRAQAvVFQARUX7yVmhAQAgECIqAADJ0KASFQXwREQPXFW6kJASEQICACCsDQqRAQAvVFQARUX7yVmhAQAgECIqAADJ0KASFQXwREQPXFW6kJASEQICACCsDQqRAQAvVFQARUX7yVmhAQAgEC/w/YTDYAjuFRwQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>The problem with that is that it thinks the data is optimally split roughly at the middle of the dataset, when in fact it would require putting change points in roughly each one third of the data. Hence, the hierarchical algorithm is not able to optimally split the dataset.</p>
</div>
<div id="a-non-usual-likelihood-function" class="section level2">
<h2>A non-usual likelihood function</h2>
<p>A segmentr likelihood function takes a segment as a matrix and returns the likelihood of the segment, so it’s necessary to build a function with that interface.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">lm_likelihood &lt;-<span class="st"> </span><span class="cf">function</span> (data) {</a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="kw">as_tibble</span>(<span class="kw">t</span>(data)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">    </span><span class="kw">rowid_to_column</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">    </span><span class="kw">gather</span>(station, temperature, <span class="op">-</span>rowid) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">    </span><span class="kw">with</span>(<span class="kw">lm</span>(temperature <span class="op">~</span><span class="st"> </span>rowid)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="st">    </span>summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="st">    </span>.<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb12-8" title="8">}</a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">c</span>(<span class="kw">lm_likelihood</span>(berlin[, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]), <span class="kw">lm_likelihood</span>(berlin[, <span class="dv">1</span><span class="op">:</span><span class="dv">150</span>]), <span class="kw">lm_likelihood</span>(berlin))</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="co">#&gt; [1] 0.98211599 0.76014938 0.03283039</span></a></code></pre></div>
<p>The <code>lm_likelihood</code> function returns a low value when compared to a hypothetical slice of the first 150 columns, so it appears reasonable. However, the highest likelihood was obtained with a segment of size 2, which indicates this function has a tendency to favor small data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">f &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(. <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">floor</span>() <span class="op">%&gt;%</span><span class="st"> </span>{ berlin[, <span class="dv">1</span><span class="op">:</span>.] } <span class="op">%&gt;%</span><span class="st"> </span>lm_likelihood)</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">curve</span>(f, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">730</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This graph represents how the likelihood of the first <span class="math inline">\(x\)</span> segments in the data, and one can see the curve has a peak close to zero. Even though it’s not the global maximum of the curve, the cumulative effect of all the segments in the data is enough to bias the solution towards small segments.</p>
</div>
<div id="penalizing-the-likelihood-function-1" class="section level2">
<h2>Penalizing the likelihood function</h2>
<p>To penalize small segments, it’s important to penalize the likelihood function to avoid non-wanted behavior. Segmentr provides the <code>auto_penalize</code> utility, which returns a penalized version of the likelihood function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">penalized_likelihood &lt;-<span class="st"> </span><span class="kw">auto_penalize</span>(berlin, lm_likelihood)</a>
<a class="sourceLine" id="cb14-2" title="2">f &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(. <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">floor</span>() <span class="op">%&gt;%</span><span class="st"> </span>{ berlin[, <span class="dv">1</span><span class="op">:</span>.] } <span class="op">%&gt;%</span><span class="st"> </span>penalized_likelihood)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">curve</span>(f, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">730</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAEGWlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VQNcC+8AACEGSURBVHgB7Z0JtE3VH8d/z0xCilempEhKHlEi/zJUhsRSUtGAshSWBs2ziiJNhJ5aSaRBpYEoRYmUWiRPlHjKWDIms/M/393/vv+7991377nvnnv3Pud891rXu+ecffb+7c/e92vPO8OyndCRAAmQgAYCxTTEyShJgARIQBGgALEgkAAJaCNAAdKGnhGTAAlQgFgGSIAEtBGgAGlDz4hJgAQoQCwDJEAC2ghQgLShZ8QkQAIUIJYBEiABbQQoQNrQM2ISIAEKEMsACZCANgIUIG3oGTEJkAAFiGWABEhAGwEKkDb0jJgESIACxDJAAiSgjQAFSBt6RkwCJEABYhkgARLQRoACpA09IyYBEqAAsQyQAAloI0AB0oaeEZMACVCAWAZIgAS0EaAAaUPPiEmABChALAMkQALaCFCAtKFnxCRAAhQglgESIAFtBChA2tAzYhIgAQoQywAJkIA2AhQgbegZMQmQAAWIZYAESEAbAQqQNvSMmARIgALEMkACJKCNAAVIG3pGTAIkQAFiGSABEtBGgAKkDT0jJgESoACxDJAACWgjQAHShp4RkwAJUIBYBkiABLQRoABpQ8+ISYAEKEAsAyRAAtoIUIC0oWfEJEACFCCWARIgAW0EKEDa0DNiEiABChDLAAmQgDYCFCBt6BkxCZAABYhlgARIQBsBCpA29IyYBEiAAsQyQAIkoI0ABUgbekZMAiRAAWIZIAES0EaAAqQNPSMmARKgALEMkAAJaCNAAdKGnhGTAAlQgFgGSIAEtBGgAGlDz4hJgAQoQCwDJEAC2ghQgLShZ8QkQAIUIJYBEiABbQQoQNrQM2ISIAEKEMsACZCANgIUIG3oGTEJkAAFiGWABEhAGwEKkDb0jJgESIACxDJAAiSgjQAFSBt6RkwCJEABYhkgARLQRoACpA09IyYBEqAAsQyQAAloI0AB0oaeEZMACVCAWAZIgAS0EaAAaUPPiEmABChALAMkQALaCFCAtKFnxCRAAhQglgESIAFtBChA2tAzYhIgAQoQywAJkIA2AhQgbegZMQmQAAWIZYAESEAbAQqQNvSMmARIoAQRFI3A888/L+PGjZOKFSsWLQC+RQIpJlCmTBn58MMP5eijj05xTEUPPsOyXdFfD+6bzZo1k8cee4wCFNwiYHzKW7duLYsWLZJGjRoZaytrQEXMmhIlSkiFChWkefPmRQyBr5FAagnUq1cvtRG4EDr7gFyAyCBIgASKRoA1oKJx8/Vb69atk/fff19ycnJkx44d0qRJEznrrLNUc/PUU09VNT+03DMyMnzNgYlLPQEKUOoZeyKGrVu3ysSJE2Xq1KmyYcMG6dSpk2peopP966+/lhEjRsjOnTtl+fLlUqVKFTn22GOlQ4cOMmjQIMnMzPREGmmkeQQoQOblSVot+uqrr2TMmDEye/Zsufzyy2XUqFFywQUXhNlwxRVX5F2j5vPbb79JSLAaNGggF110kdx5553SuHHjPH/8QgJOCLAPyAklH/rZtWuX9OvXT6655ho577zz5Pfff5cJEyYUEJ/IpKPZdeKJJ6om2ejRoyU3N1e9f/HFF8sdd9yhmmyR7/CaBAojQAEqjIyP78+fP18aNmwoJUuWVP08AwcOlPLlyxcpxZhjMmDAAFm5cqVqop1yyilqesKKFSuKFB5fChYBClCw8luGDx8uPXr0UJMoX3jhBSlXrpwrBCpXrizZ2dmycOFC1TxD/1DTpk1l7NixsnjxYlfiYCD+I0AB8l+eFpqi3r17q2bWd999Jx07dizUXzIPMPfk2WefFYykDRs2TL7//ntBvJi4OWvWrGSC5rs+JMBOaB9mamSSjhw5ojqYZ86cKdu2bXOt1hMZT+Q1OqfxgXvzzTflpptukptvvln1FUX65XUwCbAG5PN83759uxQvXlyqV68u6Hh2q8mVKDY0+5YsWSLTpk2Tdu3aqeH8RMOgf/8RYA0oIk8x5+W1116LuFvwEvNhfvjhBzn33HMLPjTkzqZNmwSjU7feeqsaXtc9cbBSpUqCDnDMN2rfvr2aS3TVVVepkTgIZFEcRBWfQ4cOyf79+9Xn8OHDapJk6dKllfhi2QxEGH9xDxzwwT38RQ0RnwMHDqj3//77b9m9e7fs2bNHXYe+Ix4IOp7jc/DgQfUO7oX8hv7iOWwqVqyY+iBedNgfc8wx6nPUUUep/xTq1q0rrVq1EjRddedPUfgn+w4FKIIgOlMxQhTPofChsJnq8GPEDOa+ffuqUSlT7CxVqpQa/u/Tp4+a4IimWVZWluA+5hRhNA4/XIgIRCEkJvv27VM/9r179+aJA374WPGNHzXEBR/U8CAsCAMfiArmLiEcMME9XOMvHL7jgxFBvIf3YQP+Yq0fhCP0Hdf41KxZU8qWLaviht2h+/ALe0JhhIQO6fjnn3/UB/OnIGQoO+gnW7BggTz55JOq475Fixaq7KG/rGXLlnL88cebkm0ps4Or4YuIFv+bPf3003LjjTcWMYTUvYYfKf5H7dKli5pkmLqY3AkZP1DMQ1q9erX6YeKHix82ag9w+AuBwI8en5Ag4D+LkB93LNEXyh9//CHffPONappClFATx8TOXr16yaWXXipIa6IOq+AnTZrE1fCJgqP/5AhgcmHPnj3liSeeSC6gNL0NEcHkRnyC6qpWrSqdO3dWHzBAje3dd9+Vt99+W2655RapX7++eoYma506dXyDiU0w32TlvwnBHkVYy/X666/7LGXBSg6ag927d1cfNBe//PJLtbkYmmboL0OnPsSoRo0angbDUTBPZ1+48Rhmx2TADz74QDVhwp/yyqsE0LfVpk0beeaZZ2Tjxo0ycuRIybWXwKCJhmkOa9as8WrShALk2awLN3zLli2Cjt0pU6ao1erhT3nlFwLoH8NOh5jFjlHO66+/Xo3GejV9bIJ5Nefy2Y1RnGuvvVZ1iGNIly4YBFAzuvrqqz2dWNaAPJ19/xrfv39/NUr08MMP+yA1TEKQCLAG5PHcxpYYWG+FoVt0XNKRgJcIUIC8lFsRtq5du1YeeeQRJT6YBEdHAl4jwCaY13Isn73ogHzwwQcF+zTTkYAXCVCAvJhrts3YuxnrjbAnMx0JeJUAm2AezDmsK8IezFhHFcQFjB7MMppcCAHWgAoBY/JtnFBx/vnnCxYv0pGAlwl4rgaEbT6d7jfcrVs3mTx5spfzp4DtOJECI1/YCoSOBLxOwHMChOnol112mdpm4f7774+5GtoLR9MmWoBw8sTgwYM9vwYo0XTTvz8JeE6AMNMXZ1lhDxmsGB4yZIg/cyZKqr799ltZtGiRow3TorzOWyRgHAHPCRAIombz6KOPCmb+3nDDDWpnPbfIYkEnTo6I59ARjIWB6XRI7z333MOFpumEzrhSSsCTAgQi2CMFO/6hFuSmQx+TEwHCKmTsxJcuF9qsCme205GAXwh4VoCw7ACrgt122BgKn3gO8WN3vnS5xx9/XNX4sDMgHQn4hYBvhuFXrVolZ5xxhixdutQveZOXDmy1gQ2psAkVHQn4iYBvBAiblufk5KiNv/2UQUjLq6++qs71wkkKdCTgJwKebYL5KRPipeXll1+WifZRNnQk4DcCvqkB+S1jQunBWevo9zH5/LGQrfxLAokS8I0A4QyloUOHSq1atRJlYLR/1HxwygUdCfiRgG+aYJmZmfLAAw/4Ko/Qr4VjWdC3RUcCfiTgmxqQHzNn+vTpcvbZZ0u1atX8mDymiQR4KobJZQBn1OOkCzoS8CsB1oAMzVks9cDcn44dOxpqIc0igeQJUICSZ5iSEObMmSPnnHOO4Ax6OhLwKwEKkKE5+9FHH8kll1xiqHU0iwTcIUABcoej66HMmDFDOnXq5Hq4DJAETCLgaBgew8DYgQ9/Q7sRnnDCCaqJgD6KKlWqmJQmz9uC9WwVKlSQunXrej4tTAAJxCIQswa0fPly1QmKRZ7YdwdzUnbt2iXr169XW53iWBhMAOzbt69s3rw5Vjx8lgCBuXPnSps2bRJ4g15JwJsEogoQDr2H4GBPZeyPs2zZMrXI8+eff5bPPvtMFi9enCdEaCps3bpVnU31xBNPyP79+71JwiCrsfyCG84blCE0JWUEogrQqFGj1Nqjn376SS1vaNiwYVQDqlevLu3btxdskvX111/LypUr5b333ovq1ys3p0yZIpUqVYr7wZlcubm5KUkWBSglWBmogQSi9gE99dRTCZvaoEEDX6zYvuKKKxyNPkF8U7HuDKdeYJfHk046KeE84Ask4DUCUWtA+ROBTuc1a9bkv5X3/eDBg3L33XfnXfvhC1aeV6xYMe4HBwIWKxYXX8JIWPtJGBlf8DCBuL+gtWvXSuPGjeWNN94ISyaaZ5goh+YanXsEKEDusWRI5hOIK0AYjenVq5dcddVVqmN6z549MmbMGDnrrLPkyJEjgqNi6NwjgGN3uPePezwZktkEovYB5TcZG6+/8MIL0qFDh7yheGwTcd9996kjYrhJen5ayX1ft26dau6iZklHAkEgELcGFIIAoSlXrpw6kRT30P+BfhA69whMnTpVunfvLiVKxP1/wb1IGRIJaCQQV4B27twpvXv3VsPtjRo1EozSoN9n2LBhqg/oxx9/1Gi+v6LGFICePXv6K1FMDQnEIBBXgHAM8rRp02TChAlqjg+WXQwcOFC+//57sSxLTVSMET4fOSQAIccs85YtWzp8g95IwPsE4tb169SpI0uWLJFTTjklLLWnnXaa4LROv22DGpbINF6g+YXaD5u1aYTOqLQTiFoDmjRpkmD4HQ5CEyk+IavRL4TlF3CYPIehemyiRZc4ATS/rrzyysRf5Bsk4GECUQUIRxNjK4j+/furJRZoahXmMCI2btw4qVevnowfP15q1KhRmFfeL4QA5v6UL19ezjzzzEJ88DYJ+JNA1CYY1ndh/g+G37EpFk7kxLwfLD2AwKCvAuu+cBwyFqhi0/SRI0fKZZddppUSamFYlY9lEl5yaH5hnhUdCQSNQFQBAoRSpUrJrbfeqkbAcDIn9gNChzRmQKNGhP2AcGLDXXfdpY4NLl26dNrYQWSwNci2bdvUeen169eXhx56SMaOHatW5sM21Mq6dOmSNpuKGhEmc7755puqU7+oYfA9EvAqgagCdOeddwpmPKMGhNoOFkbefvvtKo0QH50dpRAfjBRhOgBE8rnnnpMnn3xSRowYoWpgzZo1U3sVoTaGWcXYTsRkh3V2mF9Vs2ZNk82kbSSQEgJR+4Cw1QSG2eEwPIw5PyGnU3xgA+YgYbdAzBqGCGGGdr9+/QSiOXnyZBk8eLDarwhChGah6Q41S8yvoiOBIBKIWgNq3bq1asKgbwenMmzYsEE1twoDlM71YIgLOzGGDuu799575fXXX1dNsfz2XXfddapJlv+eid+x/WpWVpaJptEmEkg5gagChOUA6JdYsGCB6mxGX4spIzSoLaDWEHKnn366qulgC438DnOXMJqXqEPTE+mN59B3c+jQoXje4j5HWiCodCQQRAJRBQggsDEXPvPmzZPRo0fLSy+9ZASfHj16CGpo6IsaOnSo6jsZMmRInm3Yrxp9QhMnTlS1uLwHDr/MnDkzr78r1it79+6VjRs3xvLi6BmbYI4w0ZNfCdg/ZM85e9tXy96B0bL3py5guz0x0rL7qSy709yyaykFnrt1w563Y2VnZycV3Pbt2y2Ek0o7kzKQL3uagN1qsewmvtFpKLQGZLLgdu3aVTp37qxmX0faib2L0P+D0zpMd+j/QZNSd8e+6Zxon38JRB0F80JyixcvrobhQ7ZiUiSOD/rzzz89IT6wm82vUO7xb1AJeFaAIjMMS0JwcOI///wT+cjYa9SAsN0tHQkElYBvBMiLGfjdd99JkyZNvGg6bSYBVwhQgFzBmHggGEVbvXq1FHbmWuIh8g0S8B4B3wgQOp0xLJ+Ks7pSka3o/8FZatxTOxV0GaZXCHhyFCwa3MzMTE9tjoalLthhgI4EgkzANzUgr2UiBchrOUZ7U0GAApQKqg7CpAA5gEQvvidAAdKQxZgygI3cTFlfpwEBoyQBRYACpKEgYPgd4oP9jOhIIMgEKEAacn/OnDlqQa2GqBklCRhFgAKkITs+//xztee2hqgZJQkYRYAClObswFIRdEC3atUqzTEzOhIwjwAFKM15Mn/+fLVPddmyZdMcM6MjAfMI+GYioltosaHZsmXL4gaH3RCLsvCVza+4aOkhQAQoQBGZjfPOcBpIPHfw4EF1Ykg8f5HP586dK08//XTkbV6TQCAJUIAisr1du3aCTzyHzfoT3fQMRxytWLEi5gb/8eLlcxLwEwH2AaUxN7/44gs599xzOf8njcwZldkEKEBpzB/2/6QRNqPyBAEKUBqzCf0/ONGDjgRI4F8CFKA0lQScNYZjmE0/KjpNOBgNCSgCFKA0FQQc8vif//xHSpRgv3+akDMaDxCgAKUpk3788UfBKa50JEAC/ydAAfo/i5R+gwBx/+eUImbgHiRAAUpTpi1fvlydW5am6BgNCXiCAAUoDdmEWdO//PKL2oQ+DdExChLwDAHfCFBolTl+6IcPHzYqA7C8o06dOpyAaFSu0BgTCHhOgEaNGlXg9Ivhw4dL5cqV1RB3vXr15NRTT5VPPvnEBL7KBvb/GJMVNMQwAp4bE8ZKdZz/HnKvvPKK3HvvvdK2bVu5+uqr1QLRqVOnSteuXWXhwoWSlZUV8qrtLwVIG3pGbDgBz9WAInlOmDBBmjdvLtjmtE+fPnLLLbfIN998I/Xr15dnn3020ruWawqQFuyM1AMEPC9AO3bskF69ehVAfeONNwpOHzXBYQSsUaNGJphCG0jAKAKeFCCcq46RJbguXbrIhg0bCkDFtqfHHXdcgfvpvrFlyxbVLKxdu3a6o2Z8JGA8Ac/1AWVkZMi8efME+/HgaJtKlSqpvp7u3btL48aNBTsaPv744/Laa6/JmDFjEs4ANJdmzpwZ970DBw4Ial/xHI7g4fqveJT4PKgEPCdA2dnZqp9n6dKlsmTJEsFfrK/69ddflQDNmDFDxo8fLwMGDJC+ffsmnK8Qlu3bt8d9D3s6H3PMMXH9UYDiIqKHABPIsGznh/Rjj2YI0caNG+XIkSNSo0aNlCYLG4tha1X8jeU6d+4svXv3lm7dusXyxmck4DoB9DtOmjTJ6P5HT/YBRcup0CrzatWqpVx8osUfeS83N1fdWrx4sTRr1izyMa9JgARsAr4RoFWrVqm1VmiSmeDQj4T5SKiN1axZ0wSTaAMJGEfAc31AhRHct2+f5OTkFOmonMLCTOY+OsWrVq0qHTp0SCYYvksCvibgGwEyLZeqVKkiWAOGUTo6EiCB6AQoQNG5uHIXa9LoSIAECifgmz4gnNE1dOhQqVWrVuGp5RMSIAGjCPimBpSZmVlglXwqSe/fv19wygVmXOd3H374oZQsWVLKlSuX/7aR33/77TcBt9KlSxtpX36jMKqIqRWh0c78z0z7jjlp1157rRQvXlyraTgIwXTnGwFKN+ixY8fKxIkTC/wgsBAWExTLly+fbpMSjg97J2GErkyZMgm/m+4X0J+2e/fuArzTbYeT+LD2D1MvdIvl4MGDjd+F0zcTEZ0UjHT4wbHO99xzj9oeJB3xJRMHJqphyQqWtJjuqlevLphThXlepjvUKCGWpUqVMt1U7fb5pg9IO0kaQAIkkDABClDCyPgCCZCAWwQoQG6RZDgkQAIJE6AAJYyML5AACbhFgALkFkmGQwIkkDABClDCyPgCCZCAWwQoQG6RZDgkQAIJE6AAJYyML5AACbhFgBMR3SL5v3DWrl0rWAnPmdDugv3pp5+kbt262mcXO0kVZkKffvrpgv3L6WIToADF5sOnJEACKSTAJlgK4TJoEiCB2AQoQLH58CkJkEAKCVCAUgiXQZMACcQmQAGKzYdPSYAEUkiAApRCuAyaBEggNgEKUGw+fEoCJJBCAhSgFMJl0CRAArEJUIBi8+FTEiCBFBKgAKUQLoMmARKITYACFJsPn5IACaSQAAXIZbiWZbkcYtGCw5n08ZwTW534iRePG8+d2OHET7K2OInDLT/J2uqF9ylALuXSq6++KhdccIE6D+zss8+WefPmuRRyYsFMnTpVHcWCkxkqV64sPXr0kPXr14cF4sRWJ37CAk3iYs+ePXLyySfLwIEDC4TixA4nfgoEnOCNOXPmqKN2ypYtKy1btpTRo0dLpNDEs+Pvv/+Wu+66Sy2qRd5069ZN/vrrrwQt8Zl3GyJdkgS++OILyz6CxbILpbVkyRKrf//+ln3WlvXDDz8kGXJir9uHIqL6ZV133XWWLYBWdna2VadOHathw4aWfZCiCsyJrU78JGZZbN8333yzsnvAgAFhHp3Y4cRPWKBFuPj8888t+5BByxZI69tvv7UeeeQRld/Tp0/PC82JHYMGDbJsobU+/fRTC/7tY5GsrKwsy66t5oUTtC9QcbokCZx22mlWz549w0I544wzrD59+oTdS/VF+/btrdq1a4cV6DfeeEP9uFHg4ZzY6sSPW2mxaxaWXRuwTjjhBCtSgJzY4cRPsrZeeOGFVseOHcO49uvXz7r88svzgo5nx7Jly6xixYpZ+UVrxYoVKm9mzZqVF07QvlCAkszx33//XRWiadOmhYV03333WfZ59WH3Un3xzjvvWLNnzw6Lxj6pVdn3wQcfWE5sdeInLIIkLnbt2mWdeOKJlt10sSDYqGGEnBM7nPgJhVfUvxs3blT8Pvvss0KDcGLHqFGjVK04VBMNBVavXj0LNaOgOvYBJdmkxvHGcDi5M7/D9Z9//ilOOoPzv5fMd/QpXHTRRWFBTJkyRW3i1bRpU3FiqxM/YREkcXHbbbdJgwYN1DnqkcE4scOJn8hwE722xUW9YguF2P+pCPr3Lr74Yvn444/zgnJix+rVq9VGdZGnpeKk1y1btuSFFbQvFKAkcxxH8MIde+yxYSHhfPjDhw9r7WRcsGCBvPjii4Ifut3EUccFx7M1Xemxmx3y1ltvKfvCwP3vwokdTvxECzuRe3YNSHm//vrrZfLkyaoDGrszdurUSd599131zIkddm1PDQpExo1yQgGKpMJrxwRKlCih/Ba2/eaBAwcch+Wmx0WLFknnzp2lefPmYneaqqCd2OrET7J27tixQ2644QYZMWKE1KxZM2pwTuxw4idq4AnchHDAYQTr119/lWeeeUb9PfPMM+WOO+5Qz5zYUbJkSbH7gJT//P+g3OgqI/nt0PW9IBFdlng0XtQs4PCjyu+2b9+uLitUqJD/dlq+26M20q5dO7FHWOSjjz4Se0ROxevEVid+kk0EfrhoimCPZ0xXwAc/cEwXwPd9+/apGhviicU1HbZmZmaq5Pbq1StvP2qIid0BLWvWrJFt27Y5stXuD5RQmcjPD/d0lJH8Nuj8/u9/3zot8HjcKFhwmzZtCkvJ5s2b5bjjjpOjjz467H6qL+bOnSuXXHKJ6guyR8DyxAfxOrHViZ9k07B06VLB5v1t27YNCyo3N1fsUSLBXyd2OPETFkERLtBHA1erVq2wt0P37c5jR7ZCLNEniGa5PaSfFxbKCeaPBdWxBpRkzqNg4QSEGTNmhIWEmkebNm3C7qX6IicnR4lP165dxR4RCxMfxO3EVid+kk2HPV9J1q1bF/ZBJ689f0ndq1GjhjG21q9fXw0w2KNgYclG/qIGh74/J8wgtphwiRpeyKEGhf6kdJeTUPxG/A3q8J+b6R43bpwaYsVQ/M6dO61hw4apa7vPwM1o4oZlN7sse6au9fzzz6tJiJiIGPqsXLlSve/EVid+4hqToIfIYXi87sQOJ34SNKWA96eeekrN4XnppZcsuxZjjRw5UuWv3R+U59eJHa1bt1bTDVatWmXZzU3LFh7rvPPOC5tflBdgQL5wHpALGX3o0CHLHmmy7L4BNWcEk9IwtyWdLjRfxf5fTdkQ+Rc/Hjgntjrx43baogmQEzuc+EnWVsxUHjp0qFWuXDnFtlKlSpa9pCIsWCd2QHRatGihwrA7ri1McMRkxCA7ngvmYj0Unad//PFHgf4CF6NwLSgntjrx45pBMQJyYocTPzGicPQI/Tfon7Jnm4f14+R/2YkdW7duVSNiWA8WdEcBCnoJYPpJQCMBdkJrhM+oSSDoBChAQS8BTD8JaCRAAdIIn1GTQNAJUICCXgKYfhLQSIACpBE+oyaBoBOgAAW9BDD9JKCRAAVII3xGTQJBJ0ABCnoJYPpJQCMBCpBG+IyaBIJOgAIU9BLA9JOARgIUII3wGTUJBJ0ABSjoJYDpJwGNBChAGuEzahIIOgEKUNBLANNPAhoJUIA0wmfUJBB0AhSgoJcApp8ENBKgAGmEz6hJIOgEKEBBLwFMPwloJEAB0gifUZNA0AlQgIJeAph+EtBIgAKkET6jJoGgE6AABb0EMP0koJEABUgjfEZNAkEnQAEKeglg+klAIwEKkEb4jJoEgk6AAhT0EsD0k4BGAhQgjfAZNQkEnQAFKOglgOknAY0EKEAa4Qc96unTp0vTpk1l9uzZeSgWLlyo7r3//vt59/jFvwQyLNv5N3lMmckEDh8+LC1atJCtW7dKTk6OoChmZWVJZmamzJs3T4oV4/+PJuefG7aVcCMQhkECRSFQvHhxeeWVV6RJkyYyfPhw2bNnj2zatElmzZpF8SkKUA++QwHyYKb5yeQGDRrIgw8+KI8++qgcPHhQxo8fLyeddJKfksi0xCDAJlgMOHyUHgK7d++WqlWrSunSpVUNqGzZsumJmLFoJ8BGtvYsoAEPP/ywlClTRoG4//77CSRABFgDClBmm5hUjHq1atVKxo0bJ4cOHZJBgwbJ/PnzVee0ifbSJncJUIDc5cnQEiCwd+9eNeqF5teXX36pRsFatmwp27Ztk6VLlwqbYgnA9KhXNsE8mnF+MPuBBx6Q3Nxcyc7OloyMDDXyhe9r1qwRPKPzPwHWgPyfx0whCRhLgDUgY7OGhpGA/wlQgPyfx0whCRhLgAJkbNbQMBLwPwEKkP/zmCkkAWMJUICMzRoaRgL+J0AB8n8eM4UkYCwBCpCxWUPDSMD/BChA/s9jppAEjCVAATI2a2gYCfifAAXI/3nMFJKAsQQoQMZmDQ0jAf8ToAD5P4+ZQhIwlgAFyNisoWEk4H8CFCD/5zFTSALGEqAAGZs1NIwE/E+AAuT/PGYKScBYAhQgY7OGhpGA/wlQgPyfx0whCRhLgAJkbNbQMBLwPwEKkP/zmCkkAWMJUICMzRoaRgL+J0AB8n8eM4UkYCwBCpCxWUPDSMD/BP4LC1EF6SG2FWcAAAAASUVORK5CYII=" /><!-- --></p>
<p>The new likelihood curve penalizes segments too big or too small, indicating it might work as we expect.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
